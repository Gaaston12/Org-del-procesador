<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Practical Electronics for Inventors, Third Edition</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body class="calibre">
<div class="calibre35"> </div>
<div class="calibre26"><span>To create a clocked, edge-triggered, D-type flip-flop, take a clocked edge-triggered SR flip-flop and add an inverter, as shown in <a href="#filepos2817256">Fig. 12.79</a>.</span></div>
<div id="filepos2817256" class="calibre3"><span><img alt="image" src="images/01767.jpg" class="calibre1524"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.79</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span><a href="#filepos2817850">Figure 12.80</a> shows a popular edge-triggered D-type flip-flop IC, the 7474 (for example, the 74HC74). It contains two D-type positive edge-triggered flip-flops with asynchronous preset and clear inputs.</span></div>
<div id="filepos2817850" class="calibre3"><span><img alt="image" src="images/01768.jpg" class="calibre1525"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.80</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span><a></a>Note the lowercase letters <span class="italic">l</span> and <span class="italic">h</span> in the truth table in this figure. The <span class="italic">h</span> is similar to the <span class="italic">H</span> for a high voltage level, and the <span class="italic">l</span> is similar to the <span class="italic">L</span> for low voltage level; however, there is an additional condition that must be met for the flip-flop’s output to do what the truth table indicates. The additional condition is that the <span class="italic">D</span> input must be fixed high (or low) in duration for at least one <span class="italic">setup time</span> (<span class="italic">t<sub class="calibre37"><small class="calibre28"><span class="calibre17">s</span></small></sub></span>) before the positive clock edge. This condition stems from the real-life propagation delays present in flip-flop ICs. If you try to make the flip-flop switch states too fast (do not give it time to move electrons around), you can end up with inaccurate output readings. For the 7474, the setup time is 20 ns. Therefore, when using this IC, you must not apply input pulses that are within the 20-ns limit. Other flip-flops will have different setup times, so you will need to check the manufacturer’s data sheets. I will discuss setup time and some other flip-flop timing parameters in greater detail in <a href="#filepos2839387">Section 12.6.6</a>.</span></div>
<div class="calibre26"><span>D-type flip-flops are sometimes found in the pulse-triggered (master-slave) variety. Recall that a pulse-triggered flip-flop requires a complete clock pulse before the outputs will reflect what is applied at the input(s) (in this case, the <span class="italic">D</span> input). <a href="#filepos2819986">Figure 12.81</a> shows the basic structure of a pulse-triggered <span class="italic">D</span> flip-flop. It is almost exactly like the pulse-triggered SR flip-flop, except for the inverter addition to the master’s input.</span></div>
<div id="filepos2819986" class="calibre3"><span><img alt="image" src="images/01769.jpg" class="calibre73"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.81</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span>Now let’s look at a few simple D-type flip-flop applications.</span></div>
<div class="calibre3"><span><a></a><span class="bold">Stop and Go</span></span></div>
<div class="calibre11"><span>In the stop-go indicator circuit, a simple level-triggered D-type flip-flop is used to turn on a red LED when its <span class="italic">D</span> input is low (reset) and turn on a green LED when the <span class="italic">D</span> input is high (set). Only one LED can be turned on at a time.</span></div>
<div class="calibre26"><span>The divide-by-two counter uses a positive edge-triggered D-type flip-flop to divide an applied signal’s frequency by two. The explanation of how this works is simple: The positive edge-triggered feature does not care about negative edges. You can figure out the rest.</span></div>
<div class="calibre3"><span><span class="bold">External Asynchronous Control Signal</span></span></div>
<div class="calibre11"><span>A synchronizer is used when you want to use an external asynchronous control signal (perhaps generated by a switch or other input device) to control some action within a synchronous system. The synchronizer provides a means of keeping the phase of the action generated by the control signal in synch with the phase of the synchronous system.</span></div>
<div class="calibre26"><span>For example, say you want an asynchronous control signal to control the number of clock pulses that get from point A to point <span class="italic">B</span> within a synchronous system. You might try using a simple enable gate, as shown below the synchronizer circuit in <a href="#filepos2822392">Fig. 12.82</a>. However, because the external control signal is not synchronous (in phase) with the clock, when you apply the external control signal, you may shorten the first or last output pulse, as shown in the lower timing diagram.</span></div>
<div id="filepos2822392" class="calibre3"><span><img alt="image" src="images/01770.jpg" class="calibre168"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.82</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span>Certain applications do not like shortened clock pulses and will not function properly. To avoid shortened pulses, throw in an edge-triggered D-type flip-flop to create a synchronizer. The flip-flop’s CLK input is tapped off the input clock line, its <span class="italic">D</span> input receives the external control signal, and its <span class="italic">Q</span> output is connected to the AND gate’s enable input. With this arrangement, there will never be shortened clock pulses because the <span class="italic">Q</span> output of the flip-flop will not supply enable pulses to the AND gate that are out of phase with the input clock signal. This is due to the fact that after the flip-flop’s CLK input receives a positive clock edge, the flip-flop ignores any input changes applied to the <span class="italic">D</span> input until the next positive clock edge.</span></div>
<div id="filepos2823558" class="calibre48"><span class="bold"><span class="italic"><span><span class="bold"><span class="italic">12.6.4   Quad and Octal D Flip-Flops</span></span></span></span></span></div>
<div class="calibre11"><span><a></a>Most frequently, you will find a number of <span class="italic">D</span> flip-flops or <span class="italic">D</span> latches grouped together within a single IC. For example, the 74HC75, shown in <a href="#filepos2824918">Fig. 12.83</a>, contains four transparent D latches. Latches 0 and 1 share a common active-low enable <span class="italic">E</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> – <span class="italic">E</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">1</span></small></sub>, while latches 2 and 3 share a common active-low enable <span class="italic">E</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">2</span></small></sub> – <span class="italic">E</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">3</span></small></sub>. From the function table, each <span class="italic">Q</span> output follows each <span class="italic">D</span> input as long as the corresponding enable line is high. When the enable line goes low, the <span class="italic">Q</span> output will become latched to the value that <span class="italic">D</span> was one setup time prior to the high-to-low enable transition. The 4042 is another quad D-type latch, which works as described in <a href="#filepos2824918">Fig. 12.83</a>. D-type latches are commonly used as data registers in bus-oriented systems, as is also explained in the figure.</span></div>
<div id="filepos2824918" class="calibre3"><span><img alt="image" src="images/01771.jpg" class="calibre1148"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.83</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span>D flip-flops also come in octal form—eight flip-flops per IC. These devices are frequently used as 8-bit data registers within microprocessor systems, where devices share 8-bit or 2 × 8 = 16-bit data or address buses. An example of an octal D-type flip-flop is the 74HCT273 shown in <a href="#filepos2826297">Fig. 12.84</a>. All D flip-flops within the 74HCT273 share a common positive edge-triggered clock input and a common active-low clear input. When the clock input receives a positive edge, data bits applied to <span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> through <span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">7</span></small></sub> are stored in the eight flip-flops and appear at the outputs <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> through <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">7</span></small></sub>. To clear all flip-flops, the clear input is pulsed low. I will talk more about octal flip-flops and other bus-oriented devices in <a href="#filepos2932279">Section 12.9</a>.</span></div>
<div id="filepos2826297" class="calibre3"><span><img alt="image" src="images/01772.jpg" class="calibre170"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.84</span></span></span></div><div class="calibre35"> </div>
<div id="filepos2826573" class="calibre3"><span class="bold"><span class="italic"><span><a></a><span class="bold"><span class="italic">12.6.5   JK Flip-Flops</span></span></span></span></span></div>
<div class="calibre11"><span>Finally, we come to the last of the flip-flops: the JK flip-flop. A JK flip-flop resembles an SR flip-flop, where <span class="italic">J</span> acts like <span class="italic">S</span> and <span class="italic">K</span> acts like <span class="italic">R</span>. Likewise, it has a set mode (<span class="italic">J</span> = 1, <span class="italic">K</span> = 0), a reset mode (<span class="italic">J</span> = 0, <span class="italic">K</span> = 1), and a hold mode (<span class="italic">J</span> = 0, <span class="italic">K</span> = 0). However, unlike the SR flip-flop, which has an indeterminate mode when <span class="italic">S</span> = 1, <span class="italic">R</span> = 1, the JK flip-flop has a <span class="italic">toggle</span> mode when <span class="italic">J</span> = 1, <span class="italic">K</span> = 1. <span class="italic">Toggle</span> means that the <span class="italic">Q</span> and <img alt="image" src="images/01754.jpg" class="calibre1518"/> outputs switch to their opposite states at each active clock edge.</span></div>
<div class="calibre26"><span>To make a JK flip-flop, modify the SR flip-flop’s internal logic circuit to include two cross-coupled feedback lines between the output and input. This modification, however, means that the JK flip-flop cannot be level-triggered; it can only be edge-triggered or pulse-triggered. <a href="#filepos2828011">Figure 12.85</a> shows how you can create edge-triggered flip-flops based on the cross-NAND SR edge-triggered flip-flop.</span></div>
<div id="filepos2828011" class="calibre3"><span><img alt="image" src="images/01773.jpg" class="calibre1191"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.85</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span>Edge-triggered JK flip-flops also come with preset (asynchronous set) and clear (asynchronous reset) inputs, as shown in <a href="#filepos2828536">Fig. 12.86</a>.</span></div>
<div id="filepos2828536" class="calibre3"><span><img alt="image" src="images/01774.jpg" class="calibre382"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.86</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span>There are pulse-triggered (master-slave) flip-flops, too. These devices are similar to the pulse-triggered SR flip-flops with the exception of the distinctive JK cross-coupled feedback connections from the slave’s <span class="italic">Q</span> and <img alt="image" src="images/01754.jpg" class="calibre1518"/> outputs back to the master’s input gates. <a href="#filepos2829333">Figure 12.87</a> shows a simple NAND pulse-triggered JK flip-flop.</span></div>
<div id="filepos2829333" class="calibre3"><span><img alt="image" src="images/01775.jpg" class="calibre181"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.87</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span>The pulse-triggered flip-flops are not as popular as the edge-triggered JK flip-flops because of an undesired effect that can occur. Pulse-triggered JK flip-flops occasionally experience what is called <span class="italic">ones-catching</span>. In ones-catching, unwanted pulses or glitches caused by electrostatic noise appear on <span class="italic">J</span> and <span class="italic">K</span> while the clock is high. The flip-flop remembers these glitches and interprets them as true data. Ones-catching normally is not a problem when clock pulses are of short duration; it is when the pulses get long that you must watch out. To avoid ones-catching altogether, stick with edge-triggered JK flip-flops.</span></div>
<div class="calibre26"><span>Two major applications for JK flip-flops are found within counter and shift register circuits. Here, I will introduce a counter application. I will discuss shift registers in <a href="#filepos2898449">Section 12.8</a> and additional counter circuits in <a href="#filepos2870532">Section 12.7</a>.</span></div>
<div class="calibre3"><span><a></a><span class="bold">Ripple Counter (Asynchronous Counter)</span></span></div>
<div class="calibre11"><span>A simple counter, called a MOD-16 <span class="italic">ripple counter</span> (or <span class="italic">asynchronous counter</span>), can be constructed by joining four JK flop-flops together, as shown in <a href="#filepos2831592">Fig. 12.89</a>. (<span class="italic">MOD-16</span>, or <span class="italic">modulus 16</span>, means that the counter has 16 binary states.) This means that it can count from 0 to 15—the 0 is one of the counts.</span></div>
<div class="calibre3"><span><img alt="image" src="images/01776.jpg" class="calibre1233"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span><span class="bold">FIGURE 12.88</span></span></span></span></div><div class="calibre35"> </div>
<div id="filepos2831592" class="calibre3"><span><img alt="image" src="images/01777.jpg" class="calibre1526"/></span></div>
<div class="calibre6"><span class="calibre17"><span class="bold"><span>Each flip-flop in the ripple counter is fixed in toggle mode (<span class="italic">J</span> and <span class="italic">K</span> are both held high). The clock signal applied to the first flip-flop causes the flip-flop to divide the clock signal’s frequency by 2 at its <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> output—a result of the toggle. The second flip-flop receives <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub>’s output at its clock input and likewise divides by 2. The process continues down the line. What you get in the end is a binary counter with four digits. The LSB is <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub>, while the MSB is <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">3</span></small></sub>. When the count reaches 1111, the counter recycles back to 0000 and continues from there. To reset the counter at any given time, the active-low clear line is pulsed low. To make the counter count backward from 1111 to 0000, you would simply use the <span class="italic"><img alt="image" src="images/01778.jpg" class="calibre1527"/></span> outputs.</span></span></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span><span class="bold">FIGURE 12.89</span></span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span>The ripple counter in <a href="#filepos2831592">Fig. 12.89</a> also can be used as a divide-by-2, -4, -8, or -16 counter. Here, you simply replace the clock signal with any desired input signal that you wish to divide in frequency. To get a divide-by-2 counter, you only need the first flip-flop; to get a divide-by-8 counter, you need the first three flip-flops.</span></div>
<div class="calibre26"><span><a></a>Ripple counters with higher MOD values can be constructed by slapping on more flip-flops to the MOD-16 counter. But how do you create a ripple counter with a MOD value other than 2, 4, 8, 16, and so on? For example, say you want to create a MOD-10 (0 to 9) ripple counter. And what do you do if you want to stop the counter after a particular count has been reached and then trigger some device, such as an LED or buzzer? <a href="#filepos2834079">Figure 12.90</a> shows just such a circuit.</span></div>
<div id="filepos2834079" class="calibre3"><span><img alt="image" src="images/01779.jpg" class="calibre1528"/></span></div>
<div class="calibre6"><span class="calibre17"><span class="bold"><span><a></a>To make a MOD-10 counter, you simply start with the MOD-16 counter and connect the <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> and <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">3</span></small></sub> outputs to a NAND gate. When the counter reaches 9 (1001), <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> and <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">3</span></small></sub> will both go high, causing the NAND gate’s output to go low. The NAND gate then sinks current, turning the LED on, while at the same time disabling the clock-enable gate and stopping the count. (When the NAND gate is high, there is no potential difference across the LED to light it up.) To start a new count, the active-low clear line is momentarily pulsed low. Now, to make a MOD-15 counter, you would apply the same basic approach used to the left, but you would connect <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">1</span></small></sub>, <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">2</span></small></sub>, and <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">3</span></small></sub> to a three-input NAND gate.</span></span></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.90</span></span></span></div><div class="calibre35"> </div>
<div class="calibre3"><span><span class="bold">Synchronous Counter</span></span></div>
<div class="calibre11"><span>There is a problem with the ripple counter just discussed. The output stages of the flip-flops further down the line (from the first clocked flip-flop) take time to respond to changes that occur due to the initial clock signal. This is a result of the internal propagation delay that occurs within a given flip-flop. A standard TTL flip-flop may have an internal propagation delay of 30 ns. If you join four flip-flops to create a MOD-16 counter, the accumulative propagation delay at the highest-order output will be 120 ns. When used in high-precision synchronous systems, such large delays can lead to timing problems.</span></div>
<div class="calibre26"><span>To avoid large delays, you can create what is called a <span class="italic">synchronous counter</span>. Synchronous counters, unlike ripple (asynchronous) counters, contain flip-flops whose clock inputs are driven at the same time by a common clock line. This means that output transitions for each flip-flop will occur at the same time.</span></div>
<div class="calibre26"><span>With this approach, unlike with the ripple counter, you must use some additional logic circuitry placed between various flip-flop inputs and outputs to give the desired count waveform. For example, to create a 4-bit MOD-16 synchronous counter requires adding two additional AND gates, as shown in <a href="#filepos2837368">Fig. 12.91</a>. The AND gates act to keep a flip-flop in hold mode (if both inputs of the gate are low) or toggle mode (if both inputs of the gate are high), as follows:</span></div>
<div id="filepos2837368" class="calibre3"><span><img alt="image" src="images/01780.jpg" class="calibre1529"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.91</span></span></span></div><div class="calibre35"> </div>
<div class="calibre187"><span>•  During the 0–1 count, the first flip-flop is in toggle mode (and always is); all the rest are in hold mode.</span></div>
<div class="calibre27"><span>•  When it is time for the 2–4 count, the first and second flip-flops are placed in toggle mode; the last two are held in hold mode.</span></div>
<div class="calibre27"><span>•  When it is time for the 4–8 count, the first AND gate is enabled, allowing the third flip-flop to toggle.</span></div>
<div class="calibre27"><span>•  When it is time for the 8–15 count, the second AND gate is enabled, allowing the last flip-flop to toggle.</span></div>
<div class="calibre30"><span>You can work out the details for yourself by studying the circuit and timing waveforms.</span></div>
<div class="calibre26"><span><a></a>The ripple (asynchronous) and synchronous counters discussed so far are simple but hardly ever used. In practice, if you need a counter—ripple or synchronous—you purchase a counter IC. These ICs are often MOD-16 or MOD-10 counters and usually come with many additional features. For example, many ICs allow you to preset the count to a desired number via parallel input lines. Others allow you to count up or to count down by means of control inputs. Counter ICs are discussed in <a href="#filepos2870532">Section 12.7</a>.</span></div>
<div id="filepos2839387" class="calibre48"><span class="bold"><span class="italic"><span><span class="bold"><span class="italic">12.6.6   Practical Timing Considerations with Flip-Flops</span></span></span></span></span></div>
<div class="calibre11"><span>When working with flip-flops, it is important to avoid race conditions. For example, a typical race condition would occur if, say, you were to apply an active clock edge at the very moment you apply a high or low pulse to one of the inputs of a JK flip-flop. Since the JK flip-flop uses what is present on the inputs at the moment the clock edge arrives, having a high-to-low input change will cause problems because you cannot determine if the input is high or low at that moment—it is a straight line.</span></div>
<div class="calibre26"><span>To avoid this type of race condition, you must hold the inputs of the flip-flop high or low for at least one setup time <span class="italic">t<sub class="calibre37"><small class="calibre28"><span class="calibre17">s</span></small></sub></span> before the active clock transition. If the input changes during the <span class="italic">t<sub class="calibre37"><small class="calibre28"><span class="calibre17">s</span></small></sub></span> to the clock edge region, the output levels will be unreliable.</span></div>
<div class="calibre26"><span>To determine the setup time for a given flip-flop, you must look through the manufacturer’s data sheets. For example, the minimum setup time for the 74LS76 JK flip-flop is 20 ns. Other timing parameters, such as hold time and propagation delay, are also given by the manufacturers. A description of what these parameters mean is given in <a href="#filepos2841110">Fig. 12.92</a>.</span></div>
<div id="filepos2841110" class="calibre3"><span><img alt="image" src="images/01781.jpg" class="calibre1530"/></span></div>
<div class="calibre3"><span><a></a><span class="bold">IMPORTANT TERMS</span></span></div>
<div class="calibre6"><span class="calibre17"><span class="bold"><span><span class="italic">Setup time t<sub class="calibre37"><small class="calibre28"><span class="calibre17">s</span></small></sub></span>: The time that the input must be held before the active clock edge for proper operation. For a typical flip-flop, <span class="italic">t<sub class="calibre37"><small class="calibre28"><span class="calibre17">s</span></small></sub></span> is around 20 ns.</span></span></span></div>
<div class="calibre6"><span class="calibre17"><span class="bold"><span><span class="italic">Hold time t<sub class="calibre37"><small class="calibre28"><span class="calibre17">h</span></small></sub></span>: The time that the input must be held after the active clock edge for proper operation. For most flip-flops, this is 0 ns—meaning inputs need not be held beyond the active clock signal.</span></span></span></div>
<div class="calibre6"><span class="calibre17"><span class="bold"><span><span class="italic">T<sub class="calibre37"><small class="calibre28"><span class="calibre17">PLH</span></small></sub></span>: Propagation delay from clock trigger point to the low-to-high <span class="italic">Q</span> output swing. A typical <span class="italic">T<sub class="calibre37"><small class="calibre28"><span class="calibre17">PLH</span></small></sub></span> for a flip-flop is around 20 ns.</span></span></span></div>
<div class="calibre6"><span class="calibre17"><span class="bold"><span><span class="italic">T<sub class="calibre37"><small class="calibre28"><span class="calibre17">PHL</span></small></sub></span>: Propagation delay from clock trigger point to the high-to-low <span class="italic">Q</span> output swing. A typical <span class="italic">T<sub class="calibre37"><small class="calibre28"><span class="calibre17">PLH</span></small></sub></span> for a flip-flop is around 20 ns.</span></span></span></div>
<div class="calibre6"><span class="calibre17"><span class="bold"><span><span class="italic">f<sub class="calibre37"><small class="calibre28"><span class="calibre17">max</span></small></sub></span>: Maximum frequency allowed at the clock input. Any frequency above this limit will result in unreliable performance. This can vary greatly.</span></span></span></div>
<div class="calibre6"><span class="calibre17"><span class="bold"><span><span class="italic">t<sub class="calibre37"><small class="calibre28"><span class="calibre17">W</span></small></sub></span>(<span class="italic">L</span>): Clock pulse width (low), the minimum width (in nanoseconds) that is allowed at the clock input during the low level for reliable operation.</span></span></span></div>
<div class="calibre6"><span class="calibre17"><span class="bold"><span><span class="italic">t<sub class="calibre37"><small class="calibre28"><span class="calibre17">W</span></small></sub></span>(<span class="italic">H</span>): Clock pulse width (high), the minimum width (in nanoseconds) that is allowed at the clock input during the high level for reliable operation.</span></span></span></div>
<div class="calibre6"><span class="calibre17"><span class="bold"><span><span class="italic">Preset or clear pulse width</span>: Also given by <span class="italic">t<sub class="calibre37"><small class="calibre28"><span class="calibre17">W</span></small></sub></span>(<span class="italic">L</span>), the minimum width (in nanoseconds) of the low pulse at the preset or clear inputs.</span></span></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.92</span></span></span></div><div class="calibre35"> </div>
<div id="filepos2844304" class="calibre3"><span class="bold"><span class="italic"><span><span class="bold"><span class="italic">12.6.7   Digital Clock Generators and Single-Pulse Generators</span></span></span></span></span></div>
<div class="calibre11"><span>You have already seen the importance of clock and single-pulse control signals. Now let’s take a look at some circuits that can generate these signals.</span></div>
<div class="calibre3"><span><span class="bold">Clocks (Astable Multivibrators)</span></span></div>
<div class="calibre11"><span>A clock is simply a squarewave oscillator. <a href="CR%21QKYKJ7KY3158K36EJE0G9AYNF2ZW_split_015.html#filepos2503646">Chapter 10</a> discusses ways to generate squarewaves, so you can refer there to learn the theory. Here, I will simply present some practical circuits. Digital clocks can be constructed from discrete components such as logic gates, capacitors, resistors, and crystals, or can be purchased in IC form. <a href="#filepos2845406">Figure 12.93</a> shows some sample clock generators.</span></div>
<div id="filepos2845406" class="calibre3"><span><img alt="image" src="images/01782.jpg" class="calibre809"/></span></div>
<div class="calibre6"><span class="calibre17"><span class="bold"><span>Figure a. Here, two CMOS inverters are connected together to form an <span class="italic">RC</span> relaxation oscillator with squarewave output. The output frequency is determined by the <span class="italic">RC</span> time constant, as shown in the figure.</span></span></span></div>
<div class="calibre26"><span class="calibre17"><span class="bold"><span>Figure b. The previous oscillator has one problem: it may not oscillate if the transition regions of its two gates differ, or it may oscillate at a slightly lower frequency than the equation predicts due to the finite gain of the leftmost gate. The oscillator shown here resolves these problems by adding hysteresis via the additional <span class="italic">RC</span> network.</span></span></span></div>
<div class="calibre26"><span class="calibre17"><span class="bold"><span>Figure c. This oscillator uses a pair of CMOS NAND gates and <span class="italic">RC</span> timing network along with a pot to set the frequency. A squarewave output is generated with a maximum frequency of around 2 MHz. The enable lead could be connected to the other input of the first gate, but here it is brought out to be used as a clock enable input (the clock is enabled when this lead is high).</span></span></span></div>
<div class="calibre26"><span class="calibre17"><span class="bold"><span>Figure d. Here, a TTL SR flip-flop with dual feedback resistors uses an <span class="italic">RC</span> relaxation-type configuration to generate a squarewave. The frequency of the clock is determined by the <span class="italic">R</span> and <span class="italic">C</span> values, as shown in the figure. Changing the <span class="italic">C</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">1</span></small></sub>-to-<span class="italic">C</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">2</span></small></sub> ratio changes the duty cycle.</span></span></span></div>
<div class="calibre26"><span class="calibre17"><span class="bold"><span>Figure e. When high stability is required, a crystal oscillator is the best choice for a clock generator. Here, a pair of CMOS inverters and a feedback crystal are used (see <a href="CR%21QKYKJ7KY3158K36EJE0G9AYNF2ZW_split_015.html#filepos2423538">Chapter 9</a> for details). The frequency of operation is determined by the crystal (such as 2 MHz or 10 MHz). Adjustment of the pot may be needed to start oscillations.</span></span></span></div>
<div class="calibre26"><span class="calibre17"><span class="bold"><span>Figure f. A 555 timer in astable mode can be used to generate squarewaves. Here, we slap on a JK flip-flop that is in toggle mode to provide a means of keeping the low and high times the same, as well as providing clock-enable control. The timing diagram and the equations provided within the figure paint the rest of the picture.</span></span></span></div>
<div class="calibre26"><span class="calibre17"><span class="bold"><span>Figure g. The 74S124 dual voltage-controlled oscillator (VCO) outputs squarewaves at a frequency that is dependent on the value of an external capacitor and the voltage levels applied its frequency-range input (<span class="italic">V</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">RNG</span></small></sub>) and its frequency control input (<span class="italic">V</span>freq). The graph in this figure shows how the frequency changes with capacitance, while <span class="italic">V<sub class="calibre37"><small class="calibre28"><span class="calibre17">RNG</span></small></sub></span> and <span class="italic">V</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">freq</span></small></sub> are fixed at 2 V. This device also comes with active-low enable input. Other VCOs that are designed for clock generation include the 74LS624, 4024, and 4046 PLL (Phase Locked Loop). You will find many more listed in the catalogs.</span></span></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.93</span></span></span></div><div class="calibre35"> </div>
<div class="calibre3"><span><span class="bold">Monostables (One-Shots)</span></span></div>
<div class="calibre11"><span><a></a>To generate single-pulse signals of a desired width, you can use a discrete device called a <span class="italic">monostable multivibrator</span>, or <span class="italic">one-shot</span> for short. A one-shot has only one stable state, high (or low), and can be triggered into its unstable state, low (or high), for a duration of time set by an <span class="italic">RC</span> network. One-shots can be constructed from simple gates, capacitors, and resistors. These circuits, however, tend to be “finicky” and simply are not worth talking about. If you want a one-shot, you can buy a one-shot IC, which typically costs around 50 cents.</span></div>
<div class="calibre26"><span>Two popular one-shots, shown in <a href="#filepos2850397">Fig. 12.94</a>, are the 74121 nonretriggerable monostable multivibrator and the 74123 retriggerable monostable multivibrator.</span></div>
<div id="filepos2850397" class="calibre3"><span><img alt="image" src="images/01783.jpg" class="calibre1531"/></span></div>
<div class="calibre6"><span class="calibre17"><span class="bold"><span><a></a>The 74121 has three trigger inputs (<span class="italic"><img alt="image" src="images/01679.jpg" class="calibre1491"/></span><sub class="calibre37"><small class="calibre28"><span class="calibre17">1</span></small></sub>, <span class="italic"><img alt="image" src="images/01679.jpg" class="calibre1491"/></span><sub class="calibre37"><small class="calibre28"><span class="calibre17">2</span></small></sub>, <span class="italic">B</span>), true and complemented outputs (<span class="italic">Q</span>,<img alt="image" src="images/01754.jpg" class="calibre1518"/>), and timing inputs to which an <span class="italic">RC</span> network is attached (<span class="italic">R</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">ext</span></small></sub>/<span class="italic">C</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">ext</span></small></sub>, <span class="italic">C</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">ext</span></small></sub>). To trigger a pulse from the 74123, you can choose between five possible trigger combinations, as shown in the truth table in the figure. Bringing the input trigger in on <span class="italic">B</span>, however, is attractive when dealing with slowly rising or noisy signals, since the signal is directly applied to an internal Schmitt-triggered inverter (recall hystersis). To set the desired output pulse width (<span class="italic">t<sub class="calibre37"><small class="calibre28"><span class="calibre17">w</span></small></sub></span>), a resistor/capacitor combination is connected to the <span class="italic">R</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">ext</span></small></sub>/<span class="italic">C</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">ext</span></small></sub> and <span class="italic">C</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">ext</span></small></sub> inputs, as shown. (An internal 2-k resistor is provided, which can be used alone by connecting pin 9 to <span class="italic">V<sub class="calibre37"><small class="calibre28"><span class="calibre17">CC</span></small></sub></span> and placing the capacitor across pins 10 and 11, or which can be used in series with an external resistor attached to pin 9. Here, the internal resistor will not be used.) To determine which values to give to the external resistor and capacitor, use the formula given by the manufacturer, which is shown to the left. The maximum <span class="italic">t<sub class="calibre37"><small class="calibre28"><span class="calibre17">w</span></small></sub></span> should not exceed 28 s (<span class="italic">R</span> = 40 k, <span class="italic">C</span> = 1000 μF) for reliable operation. Also, note that with a nonretriggerable one-shot like the 74121, any trigger pulses applied when the device is already in its astable state will be ignored.</span></span></span></div>
<div class="calibre3"><span><img alt="image" src="images/01784.jpg" class="calibre1532"/></span></div>
<div class="calibre6"><span class="calibre17"><span class="bold"><span>The 74123 is a dual, retriggerable one-shot. Unlike nonretriggerable one-shots, this device will not ignore trigger pulses that are applied during the astable state. Instead, when a new trigger pulse arrives during an astable state, the astable state will continue to be astable for a time of <span class="italic">t<sub class="calibre37"><small class="calibre28"><span class="calibre17">w</span></small></sub></span>. In other words, the device is simply retriggered. The 74123 has two trigger inputs (<span class="italic"><span class="bold"><img alt="image" src="images/01679.jpg" class="calibre1491"/></span>,B</span>) and a clear input (<span class="italic">CLR</span>). When <span class="italic">CLR</span> is low, the one-shot is forced back into its stable state (<span class="italic">Q</span> = low). To determine <span class="italic">t<sub class="calibre37"><small class="calibre28"><span class="calibre17">w</span></small></sub></span>, use the formula given to the left, provided <span class="italic">C</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">ext</span></small></sub> &gt; 1000 pF. If Cext &lt; 1000 pF, use <span class="italic">t</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">w</span></small></sub>/<span class="italic">C</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">ext</span></small></sub>/<span class="italic">R</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">ext</span></small></sub> graphs provided by the manufacturer to find <span class="italic">t<sub class="calibre37"><small class="calibre28"><span class="calibre17">w</span></small></sub></span>.</span></span></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.94</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span>Note that a 555 timer IC can also be used as a monostable and is a lower-cost device.</span></div>
<div class="calibre26"><span>Besides acting as simple pulse generators, one-shots can be combined to make time-delay generators and timing and sequencing circuits (see <a href="#filepos2854771">Fig. 12.95</a>).</span></div>
<div id="filepos2854771" class="calibre3"><span><img alt="image" src="images/01785.jpg" class="calibre278"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.95</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span>If you do not have a one-shot IC like the 74121, you can use a 555 timer (discussed in <a href="CR%21QKYKJ7KY3158K36EJE0G9AYNF2ZW_split_015.html#filepos2423538">Chapter 9</a>) wired in its monostable configuration, as shown in <a href="#filepos2855351">Fig. 12.96</a>.</span></div>
<div id="filepos2855351" class="calibre3"><span><img alt="image" src="images/01786.jpg" class="calibre1533"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.96</span></span></span></div><div class="calibre35"> </div>
<div class="calibre3"><span><span class="bold">One-Shot/Continuous-Clock Generator</span></span></div>
<div class="calibre11"><span>The circuit shown in <a href="#filepos2856016">Fig. 12.97</a> is a handy one-shot/continuous clock generator that is useful when you start experimenting with logic circuits.</span></div>
<div id="filepos2856016" class="calibre3"><span><img alt="image" src="images/01787.jpg" class="calibre1534"/></span></div>
<div class="calibre6"><span class="calibre17"><span class="bold"><span><a></a>In this circuit, switch <span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">2</span></small></sub> is used to select whether a single-step or a continuous-clock input is to be presented to the output. When <span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">2</span></small></sub> is in the single-step position, the cross-NAND SR flip-flop (switch debouncer) is set (<span class="italic">Q</span> = 1, <img alt="image" src="images/01754.jpg" class="calibre1518"/>= 0). This disables NAND gate <span class="italic">B</span> while enabling NAND gate <span class="italic">A</span>, which will allow a single pulse from the one-shot to pass through gate <span class="italic">C</span> to the output. To trigger the one-shot, press switch <span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">1</span></small></sub>. When <span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">2</span></small></sub> is thrown to the continuous position, the switch debouncer is reset (Q = 0, <img alt="image" src="images/01754.jpg" class="calibre1518"/> = 1). This disables NAND gate <span class="italic">A</span> and enables NAND gate <span class="italic">B</span>, allowing the clock signal generated by the 555/flip-flop to pass through gate <span class="italic">C</span> and to the output. (Just as a note to avoid confusion, you need gate <span class="italic">C</span> to prevent the output from being low and high at the same time.)</span></span></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.97</span></span></span></div><div class="calibre35"> </div>
<div id="filepos2857593" class="calibre3"><span class="bold"><span class="italic"><span><a></a><span class="bold"><span class="italic">12.6.8   Automatic Power-Up Clear (Reset) Circuits</span></span></span></span></span></div>
<div class="calibre11"><span>In sequential circuits, it is usually a good idea to clear (reset) devices when power is first applied. This ensures that devices, such as flip-flops and other sequential ICs, do not start out in a weird mode (for example, counter IC does not start counting at, say, 1101 instead of 0000). <a href="#filepos2858309">Figures 12.98</a> and <a href="#filepos2861063">12.99</a> show some techniques used to provide automatic power-up clearing.</span></div>
<div id="filepos2858309" class="calibre3"><span><img alt="image" src="images/01788.jpg" class="calibre1535"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.98</span></span></span></div><div class="calibre35"> </div>
<div class="calibre6"><span class="calibre17"><span class="bold"><span>Let’s pretend that one of the devices in a circuit has a JK flip-flop that needs clearing during power-up. In order to clear the flip-flop and then quickly return it to synchronous operations, you would like to apply a low (0) voltage to its active-low clear input; afterward, you would like the voltage to go high (at least above 2.0 V for a 74LS76 JK flip-flop). A simple way to implement this function is to use an <span class="italic">RC</span> network like the one shown in the figure. When the power is off (switch open), the capacitor is uncharged (0 V). This means that the <img alt="image" src="images/01789.jpg" class="calibre1536"/> line is low (0 V). Once the power is turned on (switch closed), the capacitor begins charging up toward <span class="italic">V<sub class="calibre37"><small class="calibre28"><span class="calibre17">CC</span></small></sub></span> (+5 V). However, until the capacitor’s voltage reaches 2.0 V, the <img alt="image" src="images/01789.jpg" class="calibre1536"/> line is considered low to the active-low clear input. After a duration of <span class="italic">t = RC</span>, the capacitor’s voltage will have reached 63 percent of <span class="italic">V<sub class="calibre37"><small class="calibre28"><span class="calibre17">CC</span></small></sub></span>, or 3.15 V; after a duration of <span class="italic">t = 5RC</span>, its voltage will be nearly equal to +5 V. Since the 74LS76’s <img alt="image" src="images/01789.jpg" class="calibre1536"/> input requires at least 2.0 V to be placed back into synchronous operations, you know that <span class="italic">t = RC</span> is long enough. Thus, by rough estimate, if you want the <img alt="image" src="images/01789.jpg" class="calibre1536"/> line to remain low for 1 μs after power-up, you must set <span class="italic">RC</span> = 1 μs. Setting <span class="italic">R</span> = 1 k and <span class="italic">C</span> = 0.001 μ<span class="italic">F</span> does the trick.</span></span></span></div>
<div class="calibre26"><span class="calibre17"><span class="bold"><span>This automatic resetting scheme can be used within circuits that contain a number of resettable ICs. If an IC requires an active-high reset (not common), simply throw in an inverter and create an active-high clear line, as shown in the figure. Depending on the device being reset, the length of time that the clear line is at a low will be about 1 μs. As more devices are placed on the clear line, the low time duration will decrease due to the additional charging paths. To prevent this from occurring, a larger capacitor can be used.</span></span></span></div>
<div id="filepos2861063" class="calibre3"><span><img alt="image" src="images/01790.jpg" class="calibre1537"/></span></div>
<div class="calibre26"><span class="calibre17"><span class="bold"><span>An improved automatic power-up clear circuit is shown in <a href="#filepos2861063">Fig. 12.99</a>. Here a Schmitt-triggered inverter is used to make the clear signal switch off cleanly. With CMOS Schmitt-triggered inverters, a diode and input resistor (<span class="italic">R</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">2</span></small></sub>) are necessary to protect the CMOS IC when power is removed.</span></span></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.99</span></span></span></div><div class="calibre35"> </div>
<div id="filepos2861828" class="calibre3"><span class="bold"><span class="italic"><span><span class="bold"><span class="italic">12.6.9   More on Switch Debouncers</span></span></span></span></span></div>
<div class="calibre11"><span>The switch debouncer shown to the far left in <a href="#filepos2862382">Fig. 12.100</a> should look familiar. It is simply a cross-NAND SR-latch-type switch debouncer. This example uses a 74LS279A IC that contains four SR latches—an ideal choice when you need a number of switch debouncers.</span></div>
<div id="filepos2862382" class="calibre3"><span><img alt="image" src="images/01791.jpg" class="calibre1538"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.100</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span><a></a>A switch debouncer does not need to be constructed from an SR latch. In fact, most any old flip-flop with preset and clear (reset) inputs can be used. For example, the middle circuit in <a href="#filepos2862382">Fig. 12.100</a> uses a 74LS74 D-type flip-flop, along with pullup resistor, as a switch debouncer. The <span class="italic">D</span> input and <span class="italic">CLK</span> input are tied to ground so that the only two modes that can be enacted are the preset and clear modes. Also, the pullup resistors will always make either the preset input or clear input high, regardless of whether the switch is bouncing. From these two facts, you can figure out the rest for yourself, using the truth table for the 74HC74 in <a href="#filepos2817850">Fig. 12.80</a> as a guide.</span></div>
<div class="calibre26"><span>Another approach that can be used to debounce an SPST switch is shown on the far right in <a href="#filepos2862382">Fig. 12.100</a>. This debouncer uses a Schmitt-triggered inverter along with a unique <span class="italic">RC</span> timing network. When the switch is open, the capacitor is fully charged (+5 V), and the output is low. When the switch is closed, the capacitor discharges rapidly to ground through the 100-Ω resistor, causing the output to go high. Now, as the switch bounces, the capacitor will repeatedly attempt to charge slowly back to +5 <span class="italic">V</span> via the 10-k resistor, and then again will discharge rapidly to zero through the 100-W resistor, making the output high. By making the 10-k pullup resistor larger than the 100-Ω discharge resistor, the voltage across the capacitor or the voltage applied to the inverter’s input will not get a chance to exceed the positive threshold voltage (<img alt="image" src="images/01746.jpg" class="calibre1516"/>) of the inverter during a bounce. Therefore, the output remains high, regardless of the bouncing switch. In this example, the charge-up time constant (<span class="italic">R<sub class="calibre37"><small class="calibre28"><span class="calibre17">2</span></small></sub>C</span> = 10 k × 0.1 μF) ensures sufficient leeway. When the switch is reopened, the capacitor charges up toward +5 V. When the capacitor’s voltage reaches <img alt="image" src="images/01746.jpg" class="calibre1516"/>, the output switches low.</span></div>
<div id="filepos2865010" class="calibre48"><span class="bold"><span class="italic"><span><span class="bold"><span class="italic">12.6.10   Pullup and Pulldown Resistors</span></span></span></span></span></div>
<div class="calibre11"><span>As you learned when dealing with the switch debouncer circuits, a pullup resistor is used to keep an input high that would otherwise float if left unconnected. If you want to set the “pulled up” input low, you can ground the pin, say, via a switch.</span></div>
<div class="calibre26"><span>It is important to get an idea of the size of pullup resistor to use. The key here is to make the resistor value small enough so that the voltage drop across it does not weigh down the input voltage below the minimum high threshold voltage (<span class="italic">V<sub class="calibre37"><small class="calibre28"><span class="calibre17">IH,min</span></small></sub></span>) of the IC. At the same time, you do not want to make it too small; otherwise, when you ground the pin, excessive current will be dissipated.</span></div>
<div class="calibre26"><span><a></a>In the left diagram in <a href="#filepos2862382">Fig. 12.100</a>, a 10-k pullup resistor is used to keep a 74LS device’s input high. To make the input low, close the switch. To figure out if the resistor is large enough so as not to weigh down the input, use <span class="italic">V</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">in</span></small></sub> = +5 V − <span class="italic">RI<sub class="calibre37"><small class="calibre28"><span class="calibre17">IH</span></small></sub></span>, where <span class="italic">I<sub class="calibre37"><small class="calibre28"><span class="calibre17">IH</span></small></sub></span> is the current drawn into the IC during the high input state, when the switch is open. For a typical 74LS device, <span class="italic">I<sub class="calibre37"><small class="calibre28"><span class="calibre17">IH</span></small></sub></span> is around 20 μA. Thus, by applying the simple formula, you find that <span class="italic">V</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">in</span></small></sub>= 4.80 V, which is well above the <span class="italic">V</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">IH,min</span></small></sub> level for a 74LS device. Now, if you close the switch to force the input low, the power dissipated through the resistor (<span class="italic">P<sub class="calibre37"><small class="calibre28"><span class="calibre17">D</span></small></sub> = V<sup class="calibre29"><small class="calibre28"><span class="calibre17">2</span></small></sup>/R</span>) will be (5 V)<sup class="calibre29"><small class="calibre28"><span class="calibre17">2</span></small></sup>/10 k = 25 mW. The graph shown in <a href="#filepos2868223">Fig. 12.101</a> provides <span class="italic">V</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">in</span></small></sub> versus <span class="italic">R</span> and <span class="italic">P<sub class="calibre37"><small class="calibre28"><span class="calibre17">D</span></small></sub></span> versus <span class="italic">R</span> curves. As you can see, if <span class="italic">R</span> becomes too large, <span class="italic">V</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">in</span></small></sub> drops below the <span class="italic">V<sub class="calibre37"><small class="calibre28"><span class="calibre17">IH,min</span></small></sub></span> level, and the output will not go high as planned. As <span class="italic">R</span> gets smaller, the power dissipation skyrockets. To determine what value of <span class="italic">R</span> to use for a specific logic IC, you look up the <span class="italic">V</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">IH,min</span></small></sub> and <span class="italic">I</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">IH,max</span></small></sub> values within the data sheets and apply the simple formulas. In most applications, a 10-k pullup resistor will work fine.</span></div>
<div id="filepos2868223" class="calibre3"><span><img alt="image" src="images/01792.jpg" class="calibre1539"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.101</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span>You will run into situations where a pulldown resistor is used to keep a floating terminal low. Unlike a pullup resistor, the pulldown resistor must be smaller because the input low current <span class="italic">I<sub class="calibre37"><small class="calibre28"><span class="calibre17">IL</span></small></sub></span> (sourced by IC) is usually much larger than <span class="italic">I<sub class="calibre37"><small class="calibre28"><span class="calibre17">IH</span></small></sub></span>. Typically, a pulldown resistor is around 100 to 1 kΩ. A lower resistance ensures that <span class="italic">V</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">in</span></small></sub> is low enough to be interpreted as a low by the logic input. To determine if <span class="italic">V</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">in</span></small></sub> is low enough, use <span class="italic">V</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">in</span></small></sub> = 0 V + <span class="italic">I<sub class="calibre37"><small class="calibre28"><span class="calibre17">IL</span></small></sub>R</span>. As an example, use a 74LS device with an <span class="italic">I<sub class="calibre37"><small class="calibre28"><span class="calibre17">IL</span></small></sub></span> = 400 μA and a 500-Ω pulldown resistor. When the switch is open, the input will be 0.20 V—well below the <span class="italic">V<sub class="calibre37"><small class="calibre28"><span class="calibre17">IL,max</span></small></sub></span> level for the 74LS (~0.8 V). When the switch is closed, the power dissipated by the resistor will be (5 V)<sup class="calibre29"><small class="calibre28"><span class="calibre17">2</span></small></sup>/500 Ω = 50 mW. The graph shown in <a href="#filepos2868223">Fig. 12.101</a> provides <span class="italic">V</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">in</span></small></sub> versus <span class="italic">R</span> and <span class="italic">P<sub class="calibre37"><small class="calibre28"><span class="calibre17">D</span></small></sub></span> versus <span class="italic">R</span> curves. As you can see by the curves, if <span class="italic">R</span> becomes too large, <span class="italic">V</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">in</span></small></sub> surpasses <span class="italic">V</span><sub class="calibre37"><small class="calibre28"><span class="calibre17"><span class="italic">IL</span>,max</span></small></sub>, and the output will not be low as planned. As <span class="italic">R</span> gets small, the power dissipation skyrockets. If you need to use a pulldown resistor/switch arrangement, be wary of the high power dissipation through the resistor when the switch is closed.</span></div>
<div id="filepos2870532" class="calibre3"><span class="calibre7"><span><span class="bold">12.7   Counter ICs</span></span></span></div>
<div class="calibre11"><span><img alt="image" src="images/00007.jpg" class="calibre36"/></span></div>
<div class="calibre11"><span><a></a>In <a href="#filepos2826573">Section 12.6.5</a>, you saw how flip-flops could be combined to make both asynchronous (ripple) and synchronous counters. In practice, using discrete flip-flops is to be avoided. Instead, use a prefabricated counter IC. These ICs cost a dollar or two and come with many additional features, like control enable inputs, parallel loading, and so on. A number of different kinds of counter ICs are available. They come in either synchronous (ripple) or asynchronous forms and are usually designed to count in binary or binary-coded decimal (BCD).</span></div>
<div id="filepos2871502" class="calibre48"><span class="bold"><span class="italic"><span><span class="bold"><span class="italic">12.7.1   Asynchronous Counter (Ripple Counter) ICs</span></span></span></span></span></div>
<div class="calibre11"><span>Asynchronous counters work fine for many noncritical applications, but for high-frequency applications that require precise timing, synchronous counters work better. Recall that unlike an asynchronous counter, a synchronous counter contains flip-flops that are clocked at the same time, and hence the synchronous counter does not accumulate nearly as many propagation delays as is the case with the asynchronous counter. Let’s look at a few asynchronous counter ICs you will find in the electronics catalogs.</span></div>
<div class="calibre3"><span><span class="bold">7493 4-Bit Ripple Counter with Separate MOD-2 and MOD-8 Counter Sections</span></span></div>
<div class="calibre11"><span>The 7493’s internal structure consists of four JK flip-flops connected to provide separate MOD-2 (0-to-1 counter) and MOD-8 (0-to-7 counter) sections. Both the MOD-2 and MOD-8 sections are clocked by separate clock inputs. The MOD-2 section uses <span class="italic">C</span><sub class="calibre37"><small class="calibre28"><span class="calibre17"><span class="italic">p</span>0</span></small></sub> as its clock input, while the MOD-8 section uses <span class="italic">C</span><sub class="calibre37"><small class="calibre28"><span class="calibre17"><span class="italic">p</span>1</span></small></sub> as its clock input. Likewise, the two sections have separate outputs: MOD-2’s output is <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub>, while MOD-8’s outputs consist of <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">1</span></small></sub>, <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">2</span></small></sub>, and <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">3</span></small></sub>. The MOD-2 section can be used as a divide-by-2 counter. The MOD-8 section can be used as a divide-by-2 counter (output tapped at <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">1</span></small></sub>), a divide-by-4 counter (output tapped at <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">2</span></small></sub>), or a divide-by-8 counter (output tapped at <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">3</span></small></sub>). If you want to create a MOD-16 counter, simply join the MOD-2 and MOD-8 sections by wiring <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> to <span class="italic">C</span><sub class="calibre37"><small class="calibre28"><span class="calibre17"><span class="italic">p</span>1</span></small></sub>, while using <span class="italic">C</span><sub class="calibre37"><small class="calibre28"><span class="calibre17"><span class="italic">p</span>0</span></small></sub> as the single clock input.</span></div>
<div class="calibre26"><span>The MOD-2, MOD-8, or the MOD-16 counter can be cleared by making both AND-gated master reset inputs (<span class="italic">MR</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">1</span></small></sub> and <span class="italic">MR</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">2</span></small></sub>) high. To begin a count, one or both of the master reset inputs must be made low. When the negative edge of a clock pulse arrives, the count advances one step. After the maximum count is reached (1 for MOD-2, 111 for MOD-8, or 1111 for MOD-16), the outputs jump back to zero, and a new count begins.</span></div>
<div class="calibre3"><span><span class="bold">7490 4-Bit Ripple Counter with MOD-2 and MOD-5 Counter Sections</span></span></div>
<div class="calibre11"><span>The 7490, like the 7493, is another 4-bit ripple counter. However, its flip-flops are internally connected to provide MOD-2 (count-to-2) and MOD-5 (count-to-5) counter sections. Again, each section uses a separate clock: <span class="italic">C</span><sub class="calibre37"><small class="calibre28"><span class="calibre17"><span class="italic">p</span>0</span></small></sub> for MOD-2 and <span class="italic">C</span><sub class="calibre37"><small class="calibre28"><span class="calibre17"><span class="italic">p</span>1</span></small></sub> for MOD-5. By connecting <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> to <span class="italic">C</span><sub class="calibre37"><small class="calibre28"><span class="calibre17"><span class="italic">p</span>1</span></small></sub> and using <span class="italic">C</span><sub class="calibre37"><small class="calibre28"><span class="calibre17"><span class="italic">p</span>0</span></small></sub> as the single clock input, a MOD-10 counter (decade or BCD counter) can be created.</span></div>
<div class="calibre26"><span><a></a>When master reset inputs <span class="italic">MR</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">1</span></small></sub> and <span class="italic">MR</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">2</span></small></sub> are set high, the counter’s outputs are reset to 0—provided that master set inputs <span class="italic">MS</span><sup class="calibre29"><small class="calibre28"><span class="calibre17">1</span></small></sup> and <span class="italic">MS</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">2</span></small></sub> are not both high (the <span class="italic">MS</span> inputs override the <span class="italic">MR</span> inputs). When <span class="italic">MS</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">1</span></small></sub> and <span class="italic">MS</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">2</span></small></sub> are high, the outputs are set to <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> = 1, <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">1</span></small></sub> = 0, <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">2</span></small></sub> = 0, and <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">3</span></small></sub> = 1. In the MOD-10 configuration, this means that the counter is set to 9 (binary 1001). This master set feature comes in handy if you wish to start a count at 0000 after the first clock transition occurs (with master reset, the count starts out at 0001).</span></div>
<div class="calibre3"><span><img alt="image" src="images/01793.jpg" class="calibre1540"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.102</span></span></span></div><div class="calibre35"> </div>
<div class="calibre3"><span><img alt="image" src="images/01794.jpg" class="calibre809"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.103</span></span></span></div><div class="calibre35"> </div>
<div class="calibre3"><span><span class="bold">7492 Divide-by-12 Ripple Counter with MOD-2 and MOD-6 Counter Sections</span></span></div>
<div class="calibre11"><span>The 7492 is another 4-bit ripple counter that is similar to the 7490. However, it has a MOD-2 and a MOD-6 section, with corresponding clock inputs <span class="italic">C</span><sub class="calibre37"><small class="calibre28"><span class="calibre17"><span class="italic">p</span>0</span></small></sub> (MOD-2) and <span class="italic">C</span><sub class="calibre37"><small class="calibre28"><span class="calibre17"><span class="italic">p</span>1</span></small></sub> (MOD-8). By joining <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> to <span class="italic">C</span><sub class="calibre37"><small class="calibre28"><span class="calibre17"><span class="italic">p</span>1</span></small></sub>, you get a MOD-12 counter, where <span class="italic">C</span><sub class="calibre37"><small class="calibre28"><span class="calibre17"><span class="italic">p</span>0</span></small></sub> acts as the single clock input. To clear the counter, high levels are applied to master reset inputs <span class="italic">MR</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">1</span></small></sub> and <span class="italic">MR</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">2</span></small></sub>.</span></div>
<div class="calibre3"><span><img alt="image" src="images/01795.jpg" class="calibre897"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.104</span></span></span></div><div class="calibre35"> </div>
<div id="filepos2878691" class="calibre3"><span class="bold"><span class="italic"><span><a></a><span class="bold"><span class="italic">12.7.2   Synchronous Counter ICs</span></span></span></span></span></div>
<div class="calibre11"><span>Like the asynchronous counter ICs, synchronous counter ICs come in various MOD arrangements. These devices usually come with extra goodies, such as controls for up or down counting and parallel load inputs used to preset the counter to a desired start count. Synchronous counter ICs are more popular than the asynchronous ICs, not only because of these additional features, but also because they do not have such long propagation delays as asynchronous counters. Let’s take a look at a few popular IC synchronous counters.</span></div>
<div class="calibre3"><span><span class="bold">74193 Presettable 4-Bit (MOD-16) Synchronous Up/Down Counter</span></span></div>
<div class="calibre11"><span>The 74193 is a versatile 4-bit synchronous counter that can count up or count down and can be preset to any count desired—at least a number between 0 and 15. There are two separate clock inputs: <span class="italic">C<sub class="calibre37"><small class="calibre28"><span class="calibre17">pU</span></small></sub></span> is used to count up, and <span class="italic">C</span><sub class="calibre37"><small class="calibre28"><span class="calibre17"><span class="italic">pD</span></span></small></sub> is used to count down. One of these clock inputs must be held high in order for the other input to count. The binary output count is taken from <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> (2<sup class="calibre29"><small class="calibre28"><span class="calibre17">0</span></small></sup>), <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">1</span></small></sub> (2<sup class="calibre29"><small class="calibre28"><span class="calibre17">1</span></small></sup>), <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">2</span></small></sub> (2<sup class="calibre29"><small class="calibre28"><span class="calibre17">2</span></small></sup>), and <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">3</span></small></sub> (2<sup class="calibre29"><small class="calibre28"><span class="calibre17">3</span></small></sup>).</span></div>
<div class="calibre26"><span><a></a>To preset the counter to any desired count, a corresponding binary number is applied to the parallel inputs <span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> to <span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">3</span></small></sub>. When the parallel load input (<span class="italic"><img alt="image" src="images/01796.jpg" class="calibre1541"/></span>) is pulsed low, the binary number is loaded into the counter, and the count, either up or down, will start from that number. The terminal count up (<span class="italic"><img alt="image" src="images/01797.jpg" class="calibre1542"/></span>) and terminal count down (<img alt="image" src="images/01798.jpg" class="calibre1543"/>) outputs are normally high. The <span class="italic"><img alt="image" src="images/01797.jpg" class="calibre1542"/></span> output is used to indicate when the maximum count has been reached and the counter is about to recycle to the minimum count (0000)—the carry condition. Specifically, this means that <span class="italic"><img alt="image" src="images/01797.jpg" class="calibre1542"/></span> goes low when the count reaches 15 (1111) and the input clock (<span class="italic">C<sub class="calibre37"><small class="calibre28"><span class="calibre17">pU</span></small></sub></span>) goes from high to low. <img alt="image" src="images/01797.jpg" class="calibre1542"/> remains low until <span class="italic">C<sub class="calibre37"><small class="calibre28"><span class="calibre17">pU</span></small></sub></span> returns high. This low pulse at <span class="italic"><img alt="image" src="images/01797.jpg" class="calibre1542"/></span> can be used as an input to the next high-order stage of a multistage counter. The terminal count down (<img alt="image" src="images/01798.jpg" class="calibre1543"/>) output is used to indicate that the minimum count has been reached (0000) and the counter is about to recycle to the maximum count 15 (1111)—the borrow condition. Specifically, this means that <img alt="image" src="images/01798.jpg" class="calibre1543"/> goes low when the down count reaches 0000 and the input clock (<span class="italic">C</span><sub class="calibre37"><small class="calibre28"><span class="calibre17"><span class="italic">pD</span></span></small></sub>) goes low. <a href="#filepos2882845">Figure 12.105</a> provides a truth table for the 74193, along with a sample load, up-count, and down-count sequence.</span></div>
<div id="filepos2882845" class="calibre3"><span><img alt="image" src="images/01799.jpg" class="calibre1544"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.105</span></span></span></div><div class="calibre35"> </div>
<div class="calibre3"><span><span class="bold">74192 Presettable Decade (BCD or MOD-10) Synchronous Up/Down Counter</span></span></div>
<div class="calibre11"><span>The 74192, shown in <a href="#filepos2884421">Fig. 12.106</a>, is essentially the same device as the 74193, except it counts up from 0 to 9 and repeats or counts down from 9 to 0 and repeats. When counting up, the terminal count up (<img alt="image" src="images/01800.jpg" class="calibre373"/>) output goes low to indicate when the maximum count is reached (9 or 1001) and the <span class="italic">C<sub class="calibre37"><small class="calibre28"><span class="calibre17">pU</span></small></sub></span> clock input goes from high to low. <img alt="image" src="images/01800.jpg" class="calibre373"/> remains low until <span class="italic">C<sub class="calibre37"><small class="calibre28"><span class="calibre17">pU</span></small></sub></span> returns high. When counting down, the terminal count down output (<img alt="image" src="images/01801.jpg" class="calibre1545"/>) goes low when the minimum count is reached (0 or 0000) and the input clock <span class="italic">C</span><sub class="calibre37"><small class="calibre28"><span class="calibre17"><span class="italic">p</span>D</span></small></sub> goes low. The truth table and example load, count-up, and count-down sequence provided in <a href="#filepos2884421">Fig. 12.106</a> explain how the 74192 works in greater detail.</span></div>
<div id="filepos2884421" class="calibre3"><span><img alt="image" src="images/01802.jpg" class="calibre528"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.106</span></span></span></div><div class="calibre35"> </div>
<div class="calibre3"><span><span class="bold">74190 Presettable Decade (BCD or MOD-10) and 74191 Presettable 4-Bit (MOD-16) Synchronous Up/Down Counters</span></span></div>
<div class="calibre11"><span>The 74190 and the 74191 do basically the same things as the 74192 and 74193, but the input and output pins, as well as the operating modes, are a bit different. (The 74190 and the 74191 have the same pinouts and operating modes; the only difference is the maximum count.) Like the previous synchronous counters, these counters can be preset to any count by using the parallel load (<img alt="image" src="images/01796.jpg" class="calibre1541"/>) operation. However, unlike the previous synchronous counters, to count up or down requires using a single input: <img alt="image" src="images/01803.jpg" class="calibre1546"/>/D. When <span class="italic"><img alt="image" src="images/01803.jpg" class="calibre1546"/>/D</span> is set low, the counter counts up; when <span class="italic"><img alt="image" src="images/01803.jpg" class="calibre1546"/>/D</span> is high, the counter counts down.</span></div>
<div class="calibre26"><span>A clock enable input (<img alt="image" src="images/01804.jpg" class="calibre1547"/>) acts to enable or disable the counter. When <img alt="image" src="images/01804.jpg" class="calibre1547"/> is low, the counter is enabled. When <img alt="image" src="images/01804.jpg" class="calibre1547"/> is high, counting stops, and the current count is held fixed at the <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> to <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">3</span></small></sub> outputs.</span></div>
<div class="calibre26"><span><a></a>Unlike the previous synchronous counters, the 74190 and the 74191 use a single terminal count output (<span class="italic">TC</span>) to indicate when the maximum or minimum count has occurred and the counter is about to recycle. In count-down mode, <span class="italic">TC</span> is normally low but goes high when the counter reaches zero (for both the 74190 and 74191). In count-up mode, <span class="italic">TC</span> is normally low but goes high when the counter reaches 9 (for the 74190) or reaches 15 (for the 74191).</span></div>
<div class="calibre26"><span>The ripple-clock output (<img alt="image" src="images/01805.jpg" class="calibre1548"/>) follows the input clock (<span class="italic">CP</span>) whenever <span class="italic">TC</span> is high. This means, for example, that in count-down mode, when the count reaches zero, <img alt="image" src="images/01805.jpg" class="calibre1548"/> will go low when <span class="italic">CP</span> goes low. The <img alt="image" src="images/01805.jpg" class="calibre1548"/> output can be used as a clock input to the next higher stage of a multistage counter. This, however, leads to a multistage counter that is not truly synchronous because of the small propagation delay from <span class="italic">CP</span> to <img alt="image" src="images/01805.jpg" class="calibre1548"/> of each counter. To make a multistage counter that is truly synchronous, you must tie each IC’s clock to a common clock input line. You use the <span class="italic">TC</span> output to inhibit each successive stage from counting until the previous stage is at its terminal count. <a href="#filepos2888105">Figure 12.107</a> shows various asynchronous (ripple-like) and synchronous multistage counters built from 74191 ICs.</span></div>
<div id="filepos2888105" class="calibre3"><span><img alt="image" src="images/01806.jpg" class="calibre1549"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.107</span></span></span></div><div class="calibre35"> </div>
<div class="calibre3"><span><span class="bold">Presettable 4-Bit (MOD-16) Synchronous Up/Down Counter</span></span></div>
<div class="calibre11"><span>The 74160 and 74163 resemble the 74190 and 74191 but require no external gates when used in multistage counter configurations. Instead, you simply cascade counter ICs together, as shown in <a href="#filepos2888848">Fig. 12.109</a>.</span></div>
<div id="filepos2888848" class="calibre3"><span><img alt="image" src="images/01807.jpg" class="calibre398"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.109</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span><a></a>For both devices, a count can be preset by applying the desired count to the <span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> to <span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">3</span></small></sub> inputs and then applying a low to the parallel enable input (<img alt="image" src="images/01808.jpg" class="calibre1550"/>) ; the input number is loaded into the counter on the next low-to-high clock transition. The master reset (<img alt="image" src="images/01809.jpg" class="calibre1551"/>) is used to force all <span class="italic">Q</span> output low, regardless of the other input signals. The two clock enable inputs (<span class="italic">CEP</span> and <span class="italic">CET</span>) must be high for counting to begin. The terminal count output (<span class="italic">TC</span>) is forced high when the maximum count is reached, but will be forced low if <span class="italic">CET</span> goes low. This is an important feature that makes the multistage configuration synchronous, while avoiding the need for external gating. The truth tables along with the example load, count-up, and count-down timing sequences in <a href="#filepos2890372">Figs. 12.108</a> and <a href="#filepos2888848">12.109</a> should help you better understand how these two devices work.</span></div>
<div id="filepos2890372" class="calibre3"><span><img alt="image" src="images/01810.jpg" class="calibre1552"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.108</span></span></span></div><div class="calibre35"> </div>
<div id="filepos2890649" class="calibre3"><span class="bold"><span class="italic"><span><span class="bold"><span class="italic">12.7.3   A Note on Counters with Displays</span></span></span></span></span></div>
<div class="calibre11"><span>If you want to build a fairly sophisticated counter that can display many digits, the previous techniques are not worth pursuing, because there are simply too many discrete components to work with (for example, a separate seven-segment decoder/driver for each digit). A common alternative approach is to use a microcontroller that functions both as a counter and a display driver.</span></div>
<div class="calibre26"><span>What microcontrollers can do that discrete circuits have a hard time achieving is <span class="italic">multiplex</span> a display. In a multiplexed system, corresponding segments of each digit of a multidigit display are linked together, while the common lines for each digit are brought out separately. You can see that the number of lines is significantly reduced; a nonmultiplexed 7-segment 4-digit display has 28 segment lines and 4 common lines, while the 4-digit multiplexed display has only 7 + 4, or 11, lines.</span></div>
<div class="calibre26"><span>The trick to multiplexing involves flashing each digit, one after the other (and recycling), in a fast enough manner to make it appear that the display is continuously lit. In order to multiplex, the microcontroller’s program must supply the correct data to the segment lines at the same time that it enables a given digit via a control signal sent to the common lead of that digit. I will talk about multiplexing in greater detail in <a href="CR%21QKYKJ7KY3158K36EJE0G9AYNF2ZW_split_019.html#filepos3084490">Chapter 13</a>.</span></div>
<div class="calibre26"><span><a></a><a></a><a></a><a></a>Another approach used to create multidigit counters is to use a multidigit counter/display driver IC. One such IC is the ICM7217, a four-digit LED display programmable up/down counter made by Intersil. This device is typically used in hardwired applications where thumbwheel switches are used to load data and SPDT switches are used to control the chip. The ICM7217A provides multiplexed seven-segment LED display outputs that are used to drive common cathode displays.</span></div>
<div class="calibre3"><span><img alt="image" src="images/01811.jpg" class="calibre1553"/></span></div>
<div class="calibre6"><span class="calibre17"><span class="bold"><span>This simple clock-pulse generator provides a unique way to generate 60-, 10-, and 1-Hz clock signals that can be used in applications that require real-time counting. The basic idea is to take the characteristic 60-Hz ac line voltage (from the wall socket) and convert it into a lower-voltage squarewave of the same frequency. (Note that countries other than the United States typically use 50 Hz instead of 60 Hz. For 50 Hz operation, use an appropriate transformer and replace the divide-by-6 counter with the divide-by-5 counter shown in the upper left of <a href="#filepos2888848">Fig. 12.109</a>.) First, the ac line voltage is stepped down to 12.6 V by the transformer. The negative-going portion of the 12.6-V ac voltage is removed by the zener diode (which acts as a half-wave rectifier). At the same time, the zener diode clips the positive-going signal to a level equal to its reverse breakdown voltage (3.9 V). This prevents the Schmitt-triggered inverter from receiving an input level that exceeds its maximum input rating. The Schmitt-triggered inverter takes the rectified/chipped sine wave and converts it into a true squarewave. The Schmitt trigger’s output goes low (~0.2 V) when the input voltage exceeds its positive threshold voltage <img alt="image" src="images/01746.jpg" class="calibre1516"/> (~1.7 V) and goes high (~3.4 V) when its input falls below its negative threshold voltage <img alt="image" src="images/01747.jpg" class="calibre1516"/> (~0.9 V). From the inverter’s output, you get a 60-Hz squarewave (or a clock signal beating out 60 pulses per second). To get a 10-Hz clock signal, you slap on a divide-by-6 counter. To get a 1-Hz signal, you slap a divide-by-10 counter onto the output of the divide-by-6 counter.</span></span></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.110</span></span></span></div><div class="calibre35"> </div>
<div class="calibre3"><span><img alt="image" src="images/01812.jpg" class="calibre1539"/></span></div>
<div class="calibre6"><span class="calibre17"><span class="bold"><span>In the circuit shown here, three 74LS90 MOD-10 counter ICs are used to create a three-digit (decimal) counter. Features to note include an auto-reset RC network that acts to reset counters during power-up via the master reset inputs. Before the count begins, the <span class="italic">D</span> flip-flop’s <img alt="image" src="images/01754.jpg" class="calibre1518"/> output is held high, disabling the clock from reaching the first counter’s clock input. When the push button switch is closed, the flip-flop’s <img alt="image" src="images/01754.jpg" class="calibre1518"/> output goes low, enabling the first counter to count. The BCD outputs of each counter are fed through separate BCD-to-seven-segment decoder/driver ICs, which in turn drive the LED displays. The far-left counter’s output represents the count’s LSB, while the far-right counter’s output represents the count’s MSB. As shown, the last counter’s output is wired so that when a count of 600 is reached, an AND gate is enabled, causing the three-input OR gate to disable the clock (stop count) while also triggering a relay. To reset the counter, the manual reset switch is momentarily closed.</span></span></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.111</span></span></span></div><div class="calibre35"> </div>
<div class="calibre3"><span><span class="bold">Synchronous counter applications</span></span></div>
<div class="calibre3"><span><img alt="image" src="images/01813.jpg" class="calibre268"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.112</span></span></span></div><div class="calibre35"> </div>
<div class="calibre3"><span><img alt="image" src="images/01814.jpg" class="calibre1554"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.113</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span><a></a>A simple application of the ICM7217A is a four-digit unit counter shown in <a href="#filepos2898172">Fig. 12.114</a>. If you are interested in knowing all the specifics of how this counter works, along with learning about other applications for this device, check out Maxim’s data sheets at <a href="http://www.maxim-ic.com/datasheet/index.mvp/id/1501">http://www.maxim-ic.com/datasheet/index.mvp/id/1501</a>. It is better to learn from the maker in this case. Also, take a look at the other counter/display driver ICs Maxim has to offer. Other manufacturers produce similar devices, so visit their websites as well.</span></div>
<div id="filepos2898172" class="calibre3"><span><img alt="image" src="images/01815.jpg" class="calibre51"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.114</span></span></span></div><div class="calibre35"> </div>
<div id="filepos2898449" class="calibre3"><span class="calibre7"><span><span class="bold">12.8   Shift Registers</span></span></span></div>
<div class="calibre11"><span><img alt="image" src="images/00007.jpg" class="calibre36"/></span></div>
<div class="calibre11"><span>Data words traveling through a digital system frequently must be temporarily held, copied, and bit-shifted to the left or to the right. A device that can be used for such applications is the <span class="italic">shift register</span>. A shift register is constructed from a row of flip-flops connected so that digital data can be shifted down the row either in a left or right direction. Most shift registers can handle parallel movement of data bits as well as serial movement, and also can be used to convert from parallel to serial or from serial to parallel. <a href="#filepos2899555">Figure 12.115</a> shows several types of shift register arrangements: serial-in/serial-out, parallel-in/serial-out, and serial-in/parallel out.</span></div>
<div id="filepos2899555" class="calibre3"><span><img alt="image" src="images/01816.jpg" class="calibre1555"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.115</span></span></span></div><div class="calibre35"> </div>
<div id="filepos2899831" class="calibre3"><span class="bold"><span class="italic"><span><span class="bold"><span class="italic">12.8.1   Serial-In/Serial-Out Shift Registers</span></span></span></span></span></div>
<div class="calibre11"><span><a></a><a href="#filepos2900878">Figure 12.116</a> shows a simple 4-bit serial-in/serial-out shift register made from D flip-flops. Serial data is applied to the <span class="italic">D</span> input of flip-flop 0. When the clock line receives a positive clock edge, the serial data is shifted to the right from flip-flop 0 to flip-flop 1. Whatever bits of data were present at flip-flop 2’s, 3’s, and 4’s outputs are shifted to the right during the same clock pulse. To store a 4-bit word into this register requires four clock pulses. The rightmost circuit shows how you can rewire the flip-flops to make a shift-left register. To make larger bit-shift registers, more flip-flops are added (for example, an 8-bit shift register would require eight flip-flops cascaded together).</span></div>
<div id="filepos2900878" class="calibre3"><span><img alt="image" src="images/01817.jpg" class="calibre405"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.116</span></span></span></div><div class="calibre35"> </div>
<div id="filepos2901155" class="calibre3"><span class="bold"><span class="italic"><span><span class="bold"><span class="italic">12.8.2   Serial-In/Parallel-Out Shift Registers</span></span></span></span></span></div>
<div class="calibre11"><span><a href="#filepos2902011">Figure 12.117</a> shows a 4-bit serial-in/parallel-out shift register constructed from D flip-flops. This circuit is essentially the same as the previous serial-in/serial-out shift register, except now you attach parallel output lines to the outputs of each flip-flop as shown. Note that this shift register circuit also comes with an active-low clear input (<img alt="image" src="images/01789.jpg" class="calibre1536"/>) and a strobe input that acts as a clock enable control. The timing diagram in the figure shows a sample serial-to-parallel shifting sequence.</span></div>
<div id="filepos2902011" class="calibre3"><span><img alt="image" src="images/01818.jpg" class="calibre62"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.117</span></span></span></div><div class="calibre35"> </div>
<div id="filepos2902288" class="calibre3"><span class="bold"><span class="italic"><span><span class="bold"><span class="italic">12.8.3   Parallel-In/Serial-Out Shift Registers</span></span></span></span></span></div>
<div class="calibre11"><span><a></a>Constructing a 4-bit parallel-to-serial shift register from D flip-flops requires some additional control logic, as shown in the circuit in <a href="#filepos2903766">Fig. 12.118</a>. Parallel data must first be loaded into the <span class="italic">D</span> inputs of all four flip-flops. To load data, the SHIFT/<img alt="image" src="images/01819.jpg" class="calibre1556"/> is made low. This enables the AND gates with <span class="italic">X</span> marks, allowing the 4-bit parallel input word to enter the <span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub>–<span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">3</span></small></sub> inputs of the flip-flops. When strobe and CLK are both high, the 4-bit parallel word is latched simultaneously into the four flip-flops and appears at the <span class="italic">Q</span>0–<span class="italic">Q</span>3 outputs. To shift the latched data out through the serial output, the SHIFT/<img alt="image" src="images/01819.jpg" class="calibre1556"/> line is made high. This enables all unmarked AND gates, allowing the latched data bit at the <span class="italic">Q</span> output of a flip-flop to pass (shift) to the <span class="italic">D</span> input of the flip-flop to the right. In this shift mode, four clock pulses are required to shift the parallel word out of the serial output.</span></div>
<div id="filepos2903766" class="calibre3"><span><img alt="image" src="images/01820.jpg" class="calibre281"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.118</span></span></span></div><div class="calibre35"> </div>
<div id="filepos2904043" class="calibre3"><span class="bold"><span class="italic"><span><span class="bold"><span class="italic">12.8.4   Ring Counter (Shift Register Sequencer</span>)</span></span></span></span></div>
<div class="calibre11"><span>The ring counter (shift register sequencer) is a unique type of shift register that incorporates feedback from the output of the last flip-flop to the input of the first flip-flop. <a href="#filepos2905567">Figure 12.119</a> shows a 4-bit ring counter made from D-type flip-flops. In this circuit, when the <img alt="image" src="images/01821.jpg" class="calibre1557"/> input is set low, <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> is forced high by the active-low preset, while <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">1</span></small></sub>, <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">2</span></small></sub>, and <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">3</span></small></sub> are forced low (cleared) by the active-low clear. This causes the binary word 1000 to be stored within the register. When the <img alt="image" src="images/01821.jpg" class="calibre1557"/> line is brought low, the data bits stored in the flip-flops are shifted right with each positive clock edge. The data bit from the last flip-flop is sent to the <span class="italic">D</span> input of the first flip-flop. The shifting cycle will continue to recirculate while the clock is applied. To start a fresh cycle, the <img alt="image" src="images/01821.jpg" class="calibre1557"/> line is momentarily brought low.</span></div>
<div id="filepos2905567" class="calibre3"><span><img alt="image" src="images/01822.jpg" class="calibre405"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.119</span></span></span></div><div class="calibre35"> </div>
<div id="filepos2905844" class="calibre3"><span class="bold"><span class="italic"><span><a></a><span class="bold"><span class="italic">12.8.5   Johnson Shift Counter</span></span></span></span></span></div>
<div class="calibre11"><span>The Johnson shift counter is similar to the ring counter except that its last flip-flop feeds data back to the first flip-flop from its inverted output (<img alt="image" src="images/01754.jpg" class="calibre1518"/>). For this reason, this type is sometimes called a Moebius counter, as the bit sequence will be shifted out first “normally,” then inverted, then normally, and so on. In the simple 4-bit Johnson shift counter shown in <a href="#filepos2907184">Fig. 12.120</a>, you start out by applying a low to the <img alt="image" src="images/01821.jpg" class="calibre1557"/> line, which sets presets <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> high; <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">1</span></small></sub>, <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">2</span></small></sub>, and <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">3</span></small></sub> low; and <img alt="image" src="images/01754.jpg" class="calibre1518"/><sub class="calibre37"><small class="calibre28"><span class="calibre17">3</span></small></sub> high. In other words, you load the register with the binary word 1000, as you did with the ring counter.</span></div>
<div id="filepos2907184" class="calibre3"><span><img alt="image" src="images/01823.jpg" class="calibre1341"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.120</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span>Now, when you bring the <img alt="image" src="images/01821.jpg" class="calibre1557"/> line low, data will shift through the register. However, unlike the ring counter, the first bit sent back to the <span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> input of the first flip-flop will be high because feedback is from <img alt="image" src="images/01754.jpg" class="calibre1518"/><sub class="calibre37"><small class="calibre28"><span class="calibre17">3</span></small></sub> not <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">3</span></small></sub>. At the next clock edge, another high is fed back to <span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub>; at the next clock edge, another high is fed back; at the next edge, another high is fed back. Only after the fourth clock edge does a low get fed back (the 1 has shifted down to the last flip-flop and <img alt="image" src="images/01754.jpg" class="calibre1518"/><sub class="calibre37"><small class="calibre28"><span class="calibre17">3</span></small></sub> goes high). At this point, the shift register is full of 1s.</span></div>
<div class="calibre26"><span>As more clock pulses arrive, the feedback loop supplies lows to <span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> for the next four clock pulses. After that, the <span class="italic">Q</span> outputs of all the flip-flops are low, while <img alt="image" src="images/01754.jpg" class="calibre1518"/><sub class="calibre37"><small class="calibre28"><span class="calibre17">3</span></small></sub> goes high. This high from <img alt="image" src="images/01754.jpg" class="calibre1518"/><sub class="calibre37"><small class="calibre28"><span class="calibre17">3</span></small></sub> is fed back to <img alt="image" src="images/01824.jpg" class="calibre1498"/><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> during the next positive clock edge, and the cycle repeats.</span></div>
<div class="calibre26"><span>As you can see, the 4-bit Johnson shift counter has eight output stages (which require eight clock pulses to recycle), not four, as is the case with the ring counter.</span></div>
<div id="filepos2909526" class="calibre48"><span class="bold"><span class="italic"><span><span class="bold"><span class="italic">12.8.6   Shift Register ICs</span></span></span></span></span></div>
<div class="calibre11"><span>Now that we have covered the basic theory of shift registers, let’s take a look at practical shift register ICs that contain all the necessary logic circuitry inside.</span></div>
<div class="calibre3"><span><a></a><span class="bold">7491A 8-Bit Serial-In/Serial-Out Shift Register IC</span></span></div>
<div class="calibre11"><span>The 7491A is an 8-bit serial-in/serial-out shift register that consists of eight internally linked SR flip-flops. This device has positive edge-triggered inputs and a pair of data inputs (<span class="italic">A</span> and <span class="italic">B</span>) that are internally ANDed together, as shown in the logic diagram in <a href="#filepos2910756">Fig. 12.121</a>. This type of data input means that for a binary 1 to be shifted into the register, both data inputs must be high. For a binary 0 to be shifted into the register, either input can be low. Data is shifted to the right at each positive clock edge.</span></div>
<div id="filepos2910756" class="calibre3"><span><img alt="image" src="images/01825.jpg" class="calibre541"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.121</span></span></span></div><div class="calibre35"> </div>
<div class="calibre3"><span><span class="bold">74164 8-Bit Serial-In/Parallel-Out Shift Register IC</span></span></div>
<div class="calibre11"><span>The 74164 is an 8-bit serial-in/parallel-out shift register. It contains eight internally linked flip-flops and has two serial inputs, <span class="italic">D<sub class="calibre37"><small class="calibre28"><span class="calibre17">sa</span></small></sub></span> and <span class="italic">D<sub class="calibre37"><small class="calibre28"><span class="calibre17">sb</span></small></sub></span>, which are ANDed together. Like the 7491A, the unused serial input acts as an enable/disable control for the other serial input. For example, if you use <span class="italic">D<sub class="calibre37"><small class="calibre28"><span class="calibre17">sa</span></small></sub></span> as the serial input, you must keep <span class="italic">D<sub class="calibre37"><small class="calibre28"><span class="calibre17">sb</span></small></sub></span> high to allow data to enter the register, or you can keep it low to prevent data from entering the register.</span></div>
<div class="calibre26"><span>Data bits are shifted one position to the right at each positive clock edge. The first data bit entered will end up at the <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">7</span></small></sub> parallel output after the eighth clock pulse. The master reset (<img alt="image" src="images/01809.jpg" class="calibre1551"/>) resets all internal flip-flops and forces the <span class="italic">Q</span> outputs low when it is pulsed low.</span></div>
<div class="calibre26"><span>In the sample circuit shown in <a href="#filepos2912871">Fig. 12.122</a>, a serial binary number 10011010 (15410) is converted into its parallel counterpart. Note the AND gate and strobe input used in this circuit. The strobe input acts as a clock enable input; when it is set high, the clock is enabled. The timing diagram paints the rest of the picture.</span></div>
<div id="filepos2912871" class="calibre3"><span><img alt="image" src="images/01826.jpg" class="calibre304"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.122</span></span></span></div><div class="calibre35"> </div>
<div class="calibre3"><span><a></a><span class="bold">75165 8-Bit Serial-In or Parallel-In/Serial-Out Shift Register IC</span></span></div>
<div class="calibre11"><span>The 75165 is a unique 8-bit device that can act as either a serial-to-serial shift register or as a parallel-to-serial shift register. When used as a parallel-to-serial shift register, parallel data is applied to the <span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub>–<span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">7</span></small></sub> inputs and then loaded into the register when the parallel load input (<img alt="image" src="images/01827.jpg" class="calibre1558"/>) is pulsed low. To begin shifting the loaded data out of the serial output <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">7</span></small></sub> (or <img alt="image" src="images/01754.jpg" class="calibre1518"/><sub class="calibre37"><small class="calibre28"><span class="calibre17">7</span></small></sub> if you want inverted bits), the clock enable input (<img alt="image" src="images/01804.jpg" class="calibre1547"/>) must be set low to allow the clock signal to reach the clock inputs of the internal D-type flip-flops. When used as a serial-to-serial shift register, serial data is applied to the serial data input <span class="italic">DS</span>. A sample shift, load, and inhibit timing sequence is shown in <a href="#filepos2914546">Fig. 12.123</a>.</span></div>
<div id="filepos2914546" class="calibre3"><span><img alt="image" src="images/01828.jpg" class="calibre1559"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.123</span></span></span></div><div class="calibre35"> </div>
<div class="calibre3"><span><span class="bold">74194 Universal Shift Register IC</span></span></div>
<div class="calibre11"><span><a href="#filepos2916481">Figure 12.124</a> shows the 74194 4-bit bidirectional universal shift register. This device can accept either serial or parallel inputs, provide serial or parallel outputs, and shift left or right based on input signals applied to select controls <span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> and <span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">1</span></small></sub>. Serial data can be entered into either the serial shift-right input (<span class="italic">D<sub class="calibre37"><small class="calibre28"><span class="calibre17">SR</span></small></sub></span>) or the serial shift-left input (<span class="italic">D<sub class="calibre37"><small class="calibre28"><span class="calibre17">SL</span></small></sub></span>). Select controls <span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> and <span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">1</span></small></sub> are used to initiate a hold (<span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> = low, <span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">1</span></small></sub> = low), shift left (<span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> = low, <span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">1</span></small></sub> = high), shift-right (<span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> = high, <span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">1</span></small></sub> = low), or to parallel load (<span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> = high, <span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">1</span></small></sub> = high) mode. A clock pulse must then be applied to shift or parallel load the data.</span></div>
<div id="filepos2916481" class="calibre3"><span><img alt="image" src="images/01829.jpg" class="calibre1560"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.124</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span><a></a>In parallel load mode (<span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> and <span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">1</span></small></sub> are high), parallel input data is entered via the <span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> through <span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">3</span></small></sub> inputs and transferred to the <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> to <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">3</span></small></sub> outputs following the next low-to-high clock transition. The 74194 also has an asynchronous master reset (<img alt="image" src="images/01809.jpg" class="calibre1551"/>) input that forces all <span class="italic">Q</span> outputs low when pulsed low. To make a shift-right recirculating register, the <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">3</span></small></sub> output is wired back to the <span class="italic">D<sub class="calibre37"><small class="calibre28"><span class="calibre17">SR</span></small></sub></span> input, while making <span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> = high and <span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">1</span></small></sub> = low. To make a shift-left recirculating register, the <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> output is connected back to the <span class="italic">D<sub class="calibre37"><small class="calibre28"><span class="calibre17">SL</span></small></sub></span> input, while making <span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> = low and <span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">1</span></small></sub> = high. The timing diagram in <a href="#filepos2916481">Fig. 12.124</a> shows a typical parallel load and shifting sequence.</span></div>
<div class="calibre3"><span><span class="bold">74299 8-Bit Universal Shift/Storage Register with Three-State Interface</span></span></div>
<div class="calibre11"><span>A number of shift registers have three-state outputs—outputs that can assume a high, low, or high impedance state (open-circuit or float state). These devices are commonly used as storage registers in three-state bus interface applications.</span></div>
<div class="calibre26"><span>An example 8-bit universal shift/storage register with three-state outputs is the 74299, shown in <a href="#filepos2920066">Fig. 12.125</a>. This device has four synchronous operating modes that are selected via two select inputs, <span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> and <span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">1</span></small></sub>. Like the 74194 universal shift register, the 74299’s select modes include shifting right, shifting left, holding, and parallel loading (see the function table in <a href="#filepos2920066">Fig. 12.125</a>). The mode-select inputs, serial data inputs (<span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17"><span class="italic">S</span>0</span></small></sub> and <span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17"><span class="italic">S</span>7</span></small></sub>), and parallel-data inputs (<span class="italic">I</span>/<span class="italic">O</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> through <span class="italic">I/O</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">7</span></small></sub>) are positive edge triggered. The master reset (<img alt="image" src="images/01830.jpg" class="calibre1561"/>) input is an asynchronous active-low input that clears the register when pulsed low.</span></div>
<div id="filepos2920066" class="calibre3"><span><img alt="image" src="images/01831.jpg" class="calibre1562"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.125</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span>The three-state bidirectional I/O port has three modes of operation:</span></div>
<div class="calibre187"><span>•  The read-register mode allows data within the register to be available at the I/O outputs. This mode is selected by making both output-enable inputs (<img alt="image" src="images/01832.jpg" class="calibre1563"/><sub class="calibre37"><small class="calibre28"><span class="calibre17">1</span></small></sub> and <img alt="image" src="images/01832.jpg" class="calibre1563"/><sub class="calibre37"><small class="calibre28"><span class="calibre17">2</span></small></sub>) low and making one or both select inputs low.</span></div>
<div class="calibre27"><span>•  The load-register mode sets up the register for a parallel load during the next low-to-high clock transition. This mode is selected by setting both select inputs high.</span></div>
<div class="calibre27"><span>•  The disable-I/O mode acts to disable the outputs (set to a high impedance state) when a high is applied to one or both of the output-enable inputs. This effectively isolates the register from the bus to which it is attached.</span></div>
<div id="filepos2921655" class="calibre48"><span class="bold"><span class="italic"><span><a></a><span class="bold"><span class="italic">12.8.7   Simple Shift Register Applications</span></span></span></span></span></div>
<div class="calibre1"><span><span class="bold">16-Bit Serial-to-Parallel Converter</span></span></div>
<div class="calibre11"><span>A simple way to create a 16-bit serial-to-parallel converter is to join two 74164 8-bit serial-in/parallel-out shift registers, as shown in <a href="#filepos2922553">Fig. 12.126</a>. To join the two ICs, simply wire the <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">7</span></small></sub> output from the first register to one of the serial inputs of the second register. (Recall that the serial input that is not used for serial input data acts as an active-high enable control for the other serial input.)</span></div>
<div id="filepos2922553" class="calibre3"><span><img alt="image" src="images/01833.jpg" class="calibre827"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.126</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span>In terms of operation, when data is shifted out of <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">7</span></small></sub> of the first register (or data output <span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">7</span></small></sub>), it enters the serial input of the second (the example uses <span class="italic">D<sub class="calibre37"><small class="calibre28"><span class="calibre17">Sa</span></small></sub></span> as the serial input) and will be presented to the <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> output of the second register (or data output <span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">8</span></small></sub>). For an input data bit to reach the <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">7</span></small></sub> output of the second register (or data output <span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">15</span></small></sub>), 16 clock pulses must be applied.</span></div>
<div class="calibre3"><span><span class="bold">8-Bit Serial-to-Parallel Converter with Simultaneous Data Transfer</span></span></div>
<div class="calibre11"><span><a></a><a href="#filepos2925098">Figure 12.127</a> shows a circuit that acts as a serial-to-parallel converter that outputs the converted 8-bit word only when all 8 bits have been entered into the register. Here, a 74164 8-bit serial-in/parallel-out shift register is used, along with a 74HCT273 octal D-type flip-flop and a divide-by-8 counter. At each positive clock edge, the serial data is loaded into the 74164. After eight clock pulses, the first serial bit entered is shifted down to the 74164’s <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">7</span></small></sub> output, while the last serial bit entered resides at the 74164’s <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> output. At the negative edge of the eighth clock pulse, the negative-edge triggered divide-by-8 circuit’s output goes high. During this high transition, the data present on the inputs of the 74HCT273 (which hold the same data present at the 74164’s <span class="italic">Q</span> outputs) is passed to the 74HCT273’s outputs at the same time. (Think of the 74HCT273 as a temporary storage register that dumps its contents after every eighth clock pulse.)</span></div>
<div id="filepos2925098" class="calibre3"><span><img alt="image" src="images/01834.jpg" class="calibre1564"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.127</span></span></span></div><div class="calibre35"> </div>
<div class="calibre3"><span><span class="bold">8-Bit Parallel-to-Serial Interface</span></span></div>
<div class="calibre11"><span><a></a><a href="#filepos2926258">Figure 12.128</a> shows a 74165 8-bit parallel-to-serial shift register used to accept a parallel ASCII word and convert it into a serial ASCII word that can be sent to a serial device. Recall that ASCII codes are only 7 bits long (for example, the binary code for &amp; is 010 0110). How do you account for the missing bit? As it turns out, most 8-bit devices communicating via serial ASCII will use an additional eighth bit for a special purpose, perhaps to act as a parity bit or as a special function bit to enact a special set of characters. Often, the extra bit is simply set low and ignored by the serial device receiving it.</span></div>
<div id="filepos2926258" class="calibre3"><span><img alt="image" src="images/01835.jpg" class="calibre822"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.128</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span>To keep things simple, let’s set the extra bit low and assume that is how the serial device likes things done. This means that you will set the <span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> input of the 74165 low. The MSB of the ASCII code will be applied to the <span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">1</span></small></sub> input, while the LSB of the ASCII code will be applied to the <span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">7</span></small></sub> input. Now, with the parallel ASCII word applied to the inputs of the register, when you pulse the parallel load line (<span class="italic"><img alt="image" src="images/01827.jpg" class="calibre1558"/></span>) low, the ASCII word, along with the “ignored bit,” is loaded into the register. Next, you must enable the clock to allow the loaded data to be shifted out serially, by setting the clock enable input (<img alt="image" src="images/01804.jpg" class="calibre1547"/>) low for the duration it takes for the clock pulses to shift out the parallel word. After the eighth clock pulse (0 to 7), the serial device will have received all 8 serial data bits. Practically speaking, a microprocessor or microcontroller is necessary to provide the <img alt="image" src="images/01804.jpg" class="calibre1547"/> and <img alt="image" src="images/01796.jpg" class="calibre1541"/> lines with the necessary control signals to ensure that the register and serial device communicate properly.</span></div>
<div class="calibre3"><span><span class="bold">Recirculating Memory Registers</span></span></div>
<div class="calibre11"><span>A <span class="italic">recirculating memory register</span> is a shift register that is preloaded with a binary word that is serially recirculated through the register via a feedback connection from the output to the input. Recirculating registers can be used for a number of applications, from supplying a specific repetitive waveform used to drive IC inputs to driving output drivers used to control stepper motors.</span></div>
<div class="calibre26"><span><a></a>In the leftmost circuit in <a href="#filepos2929943">Fig. 12.129</a>, a parallel 4-bit binary word is applied to the <span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> to <span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">3</span></small></sub> inputs of a 74194 universal shift register. When the <span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">1</span></small></sub> select input is brought high (switch opened), the 4-bit word is loaded into the register. When the <span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">1</span></small></sub> input is then brought low (switch closed), the 4-bit word is shifted in a serial fashion through the register, out <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">3</span></small></sub>, and back to <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> via the <span class="italic">D<sub class="calibre37"><small class="calibre28"><span class="calibre17">SR</span></small></sub></span> input (serial shift-right input) as positive clock edges arrive. Here, the shift register is loaded with 0111. As you begin shifting the bits through the register, a single low output will propagate down through high outputs, which in turn causes the LED attached to the corresponding low output to turn on. In other words, you have made a simple Christmas tree flasher.</span></div>
<div id="filepos2929943" class="calibre3"><span><img alt="image" src="images/01836.jpg" class="calibre669"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.129</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span>The rightmost circuit in <a href="#filepos2929943">Fig. 12.129</a> is basically the same thing as the leftmost circuit. However, now the circuit is used to drive a stepper motor. Typically, a stepper motor has four stator coils that must be energized in sequence to make the motor turn at a given angle. For example, to make a simple stepper motor turn clockwise, you must energize its stator coils 1, 2, 3, and 4 in the following sequence: 1000, 0100, 0010, 0001, 1000, and so on. To make the motor go counterclockwise, apply the following sequence: 1000, 0001, 0010, 0100, 1000, and so on. You can generate these simple firing sequences with the 74194 by parallel loading the <span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> to <span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">3</span></small></sub> inputs with the binary word 1000. To output the clockwise firing sequence, simply shift bits to the right by setting <span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> = high and <span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">1</span></small></sub> = low. As clock pulses arrive, the 1000 present at the outputs will then become 0100, then 0010, 0001, 1000, and so on.</span></div>
<div class="calibre26"><span>The speed of rotation of the motor is determined by the clock frequency. To output the counterclockwise firing sequence, simply shift bits to the left by setting <span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> = low and <span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">1</span></small></sub> = high. To drive steppers, it is typically necessary to use a buffer/driver interface like the 7407 shown in <a href="#filepos2929943">Fig. 12.129</a>, as well a number of output transistors, not shown. Also, different types of stepper motors may require different firing sequences than the one shown here. Stepper motors and the various circuits used to drive them are discussed in detail in <a href="CR%21QKYKJ7KY3158K36EJE0G9AYNF2ZW_split_020.html#filepos3220805">Chapter 14</a>.</span></div>
<div id="filepos2932279" class="calibre3"><span class="calibre7"><span><span class="bold">12.9   Three-State Buffers, Latches, and Transceivers</span></span></span></div>
<div class="calibre11"><span><img alt="image" src="images/00007.jpg" class="calibre36"/></span></div>
<div class="calibre11"><span>Digital systems that use microprocessors require that a number of different devices (such as RAM, ROM, and I/O devices) share a common bus of some sort. For simple microprocessor systems, the data bus is often 8 bits wide (eight separate conductors). In order for devices to share the bus, only one device can be transmitting data at a time. The microprocessor decides which devices get access to the bus and which devices do not. In order for the microprocessor to control the flow of data, it may need help from an external register-type device. This device accepts a control signal issued by the microprocessor and responds by either allowing or disallowing parallel data to pass. Three popular devices used for such applications are the octal three-state buffer, octal latch/flip-flop, and transceiver.</span></div>
<div id="filepos2933514" class="calibre48"><span class="bold"><span class="italic"><span><span class="bold"><span class="italic">12.9.1   Three-State Octal Buffers</span></span></span></span></span></div>
<div class="calibre11"><span>When enabled, a three-state octal buffer passes data present on its eight inputs to its outputs unchanged. When disabled, input data is prevented from reaching the outputs—the outputs are placed in a high-impedance state. This high-impedance state makes data bus sharing between various devices possible. The octal buffer also can provide the additional sink or source current required to drive output devices.</span></div>
<div class="calibre26"><span><a></a>Three popular three-state octal buffers are shown in <a href="#filepos2935362">Fig. 12.130</a>: the 74<span class="italic">xx</span>240 is a three-state inverting octal buffer, the 74<span class="italic">xx</span>241 is a three-state Schmitt-triggered inverting octal buffer, and the 74244 is a conventional three-state octal buffer. The enable/disable control for all three devices is the same. To enable all eight outputs (allow data to pass from <span class="italic">I</span> inputs to <span class="italic">Y</span> outputs), both output enable inputs, <span class="italic"><img alt="image" src="images/01832.jpg" class="calibre1563"/><sub class="calibre37"><small class="calibre28"><span class="calibre17">a</span></small></sub></span> and <span class="italic"><img alt="image" src="images/01832.jpg" class="calibre1563"/><sub class="calibre37"><small class="calibre28"><span class="calibre17">a</span></small></sub></span>, must be set low. If you wish to enable only four outputs, make one output enable high while setting the other low (refer to the ICs in <a href="#filepos2935362">Fig. 12.130</a> to see which output enable controls which group of inverters). To disable all eight outputs, both output enables are set high. To disable only four outputs, set only one output enable input high.</span></div>
<div id="filepos2935362" class="calibre3"><span><img alt="image" src="images/01837.jpg" class="calibre1275"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.130</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span><a href="#filepos2936152">Figure 12.131</a> shows an example of how three-state inverting octal buffers can be used in an 8-bit microprocessor system. The upper buffer links one bus to a common data bus. The two lower buffers are used to link input devices to the common data bus. With programming and the help of an additional control bus, the microprocessor can select which buffer is enabled and which buffers are disabled.</span></div>
<div id="filepos2936152" class="calibre3"><span><img alt="image" src="images/01838.jpg" class="calibre1565"/></span></div>
<div class="calibre6"><span class="calibre17"><span class="bold"><span>Data from an input device or another bus passes to the data bus only when the corresponding octal buffer is enabled (input enables made low). Only one input device or bus is allowed to pass data to the data bus at a time. Here, input device 1 is the only device allowed to pass data to the data bus because its enable inputs are set low. Note that data is inverted when passed through the inverting octal buffer.</span></span></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.131</span></span></span></div><div class="calibre35"> </div>
<div id="filepos2936961" class="calibre3"><span class="bold"><span class="italic"><span><a></a><span class="bold"><span class="italic">12.9.2   Three-State Octal Latches and Flip-Flops</span></span></span></span></span></div>
<div class="calibre11"><span>A three-state octal latch or octal flip-flop, unlike a three-state octal buffer, has the ability to hold onto data present at its data inputs before transmitting the data to its outputs. In microprocessor applications, where a number of devices share a common data bus, this memory feature is handy because it allows the processor to store data, go onto other operations that require the data bus, and come back to the stored data if necessary. This feature also allows output devices to sample held bus data at leisure while the current state of the data bus is changing. To understand how three-state octal latches and flip-flops work, let’s first consider the 74<span class="italic">xx</span>373 three-state octal latch and the 74<span class="italic">xx</span>374 three-state octal flip-flop shown in <a href="#filepos2938051">Fig. 12.132</a>.</span></div>
<div id="filepos2938051" class="calibre3"><span><img alt="image" src="images/01839.jpg" class="calibre1273"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.132</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span>The 74<span class="italic">xx</span>373 octal latch contains eight D-type “transparent” latches. When its enable input (<span class="italic">E</span>) is high, the outputs (<span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub>–<span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">7</span></small></sub>) follow the inputs (<span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub>–<span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">7</span></small></sub>). When <span class="italic">E</span> is low, data present at the inputs is loaded into the latch. To place the output in a high-impedance state, the output enable (<img alt="image" src="images/01832.jpg" class="calibre1563"/>) input is set high.</span></div>
<div class="calibre26"><span><a href="#filepos2939391">Figure 12.133</a> shows a simple bus-oriented system that uses two 74HC373s to communicate with an input device and output device. Again, as with the octal buffers, control signals are typically supplied by a microprocessor.</span></div>
<div id="filepos2939391" class="calibre3"><span><img alt="image" src="images/01840.jpg" class="calibre1566"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.133</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span>The 74xx374 octal flip-flop comes with eight edge-triggered flip-flops. Unlike the octal latch, the 74xx374’s outputs are not transparent—they do not follow the inputs. Instead, a positive clock edge at clock input CP must be applied to load the device before data is presented at the <span class="italic">Q</span> outputs. To place the output in a high-impedance state, <img alt="image" src="images/01832.jpg" class="calibre1563"/> is set high. <a href="#filepos2940332">Figure 12.134</a> shows a simple bus-oriented system that uses two 74HC374s to communicate with two output devices.</span></div>
<div id="filepos2940332" class="calibre3"><span><img alt="image" src="images/01841.jpg" class="calibre1567"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.134</span></span></span></div><div class="calibre35"> </div>
<div id="filepos2940609" class="calibre3"><span class="bold"><span class="italic"><span><span class="bold"><span class="italic">12.9.3   Transceivers</span></span></span></span></span></div>
<div class="calibre11"><span><a></a><a></a>Another method for connecting devices that share a common bus is to use a transceiver. Unlike the three-state octal buffer, octal latch, and octal flip-flop, the transceiver is a bidirectional device. This means that when used in a bus-oriented system, external devices can read or write from the data bus. <a href="#filepos2941973">Figure 12.135</a> shows the 74<span class="italic">xx</span>245 octal transceiver, along with a sample application. In the application circuit, a 74LS245 is used as a bidirectional interface between two data buses. To send data from bus <span class="italic">A</span> to bus <span class="italic">B</span>, the 74LS245’s transmit/receive input (<span class="italic">T</span>/<img alt="image" src="images/01842.jpg" class="calibre1523"/>) is set high, while the output enable input (<span class="italic"><img alt="image" src="images/01832.jpg" class="calibre1563"/></span>) is set low. To send data from bus <span class="italic">B</span> to bus <span class="italic">A, T/<img alt="image" src="images/01842.jpg" class="calibre1523"/></span> is set low. To disable the transceiver’s outputs (place output in a high-impedance state), a high is applied to <span class="italic"><img alt="image" src="images/01832.jpg" class="calibre1563"/></span>.</span></div>
<div id="filepos2941973" class="calibre3"><span><img alt="image" src="images/01843.jpg" class="calibre1568"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.135</span></span></span></div><div class="calibre35"> </div>
<div id="filepos2942250" class="calibre3"><span class="calibre7"><span><span class="bold">12.10   Analog/Digital Interfacing</span></span></span></div>
<div class="calibre11"><span><img alt="image" src="images/00007.jpg" class="calibre36"/></span></div>
<div class="calibre11"><span>A number of tricks are used to interface analog circuits with digital circuits. In this section, we’ll take a look at two basic levels of interfacing. One level deals with simple on/off triggering. The other level deals with true analog-to-digital and digital-to-analog conversion—converting analog signals into digital numbers and converting digital numbers into analog signals.</span></div>
<div id="filepos2943053" class="calibre48"><span class="bold"><span class="italic"><span><span class="bold"><span class="italic">12.10.1   Triggering Simple Logic Responses from Analog Signals</span></span></span></span></span></div>
<div class="calibre11"><span>There are times when you need to drive logic from simple on/off signals generated by analog devices. For example, you may want to latch an alarm (via a flip-flop) when an analog voltage—say, one generated from a temperature sensor—reaches a desired threshold level. Or perhaps you simply want to count the number of times a certain analog threshold is reached. For simple on/off applications such as these, it is common to use a comparator or op amp as the interface between the analog output of the transducer and the input of the logic circuit. Often it is possible to simply use a voltage divider network composed of a transducer of variable resistance and a pullup resistor. <a href="#filepos2944126">Figure 12.136</a> shows some sample networks to illustrate the point.</span></div>
<div id="filepos2944126" class="calibre3"><span><img alt="image" src="images/01844.jpg" class="calibre304"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.136</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span><a></a>In <a href="#filepos2944126">Fig. 12.136a</a>, a phototransistor is used to trigger a logic response. Normally, the phototransistor is illuminated, which keeps the input of the first Schmitt inverter low. The output of the second inverter is high. When the light is briefly interrupted, the phototransistor momentarily stops conducting, causing the input to the first inverter to pulse low, while the output of the second inverter pulses high. This high pulse could be used to latch a <span class="italic">D</span> flip-flop, which could be used to trigger an LED or a buzzer alarm.</span></div>
<div class="calibre26"><span>In <a href="#filepos2944126">Fig. 12.136b</a>, a single-supply comparator with open-collector output is used as an analog-to-digital interface. When an analog voltage applied to <span class="italic">V</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">in</span></small></sub> exceeds the reference voltage (<span class="italic">V</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">ref</span></small></sub>) set at the noninverting input (+) via the pot, the output goes low (the comparator sinks current through itself to ground). When <span class="italic">V</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">in</span></small></sub> goes below <span class="italic">V<sub class="calibre37"><small class="calibre28"><span class="calibre17">ref,</span></small></sub></span> the output goes high (the comparator’s output floats, but the pullup resistor pulls the comparator’s output high).</span></div>
<div class="calibre26"><span>In <a href="#filepos2944126">Fig. 12.136c</a>, a simple application of the previous comparator interface is shown. The input voltage is generated by an LM34 or LM35 temperature sensor. The LM34 generates 10 mV/°F, while the LM35 generates 10 mV/°C. The resistance of the pot and <span class="italic">V</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">+</span></small></sub> determine the reference voltage. If we want to drive the comparator low when 75°C is reached, we set the reference voltage to 750 mV, assuming we’re using the LM35.</span></div>
<div class="calibre26"><span>In <a href="#filepos2944126">Fig. 12.136d</a>, an op amp set in comparator mode can also be used as an analog-to-digital interface for simple switching applications. CMOS logic can be driven directly through a current limiting resistor, as shown. If the supply voltage of the op amp exceeds the supply voltage of the logic, protection diodes should be used (as shown in the figure).</span></div>
<div class="calibre26"><span>Protection diodes were not necessary with the LM339 because that has open-collector outputs.</span></div>
<div class="calibre26"><span>In <a href="#filepos2944126">Fig. 12.136e</a>, an op amp that is used to drive TTL typically uses a transistor output stage like the one shown here. The diode acts to prevent base-to-emitter reverse breakdown. When <span class="italic">V</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">in</span></small></sub> exceeds <span class="italic">V</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">ref,</span></small></sub> the op amp’s output goes low, the transistor turns off, and the logic input receives a high.</span></div>
<div class="calibre26"><span>In <a href="#filepos2944126">Fig. 12.136f</a>, an <span class="italic">n</span>-channel MOSFET transistor is used as an output stage to an op amp.</span></div>  <div class="mbppagebreak"></div><div id="filepos2947894" class="calibre48"><span class="bold"><span class="italic"><span><span class="bold"><span class="italic">12.10.2   Using Logic to Drive External Loads</span></span></span></span></span></div>
<div class="calibre11"><span>Driving simple loads such as LEDs, relays, buzzers, or any device that assumes either an on or off state is relatively simple. When driving such loads, it is important to first check the driving logic’s current specifications—how much current, say, a gate can sink or source. After that, you determine how much current the device to be driven will require. If the device draws more current than the logic can source or sink, a high-power transistor typically can be used as an output switch. <a href="#filepos2948766">Figure 12.137</a> shows some sample circuits used to drive various loads.</span></div>
<div id="filepos2948766" class="calibre3"><span><img alt="image" src="images/01845.jpg" class="calibre1128"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.137</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span>In <a href="#filepos2948766">Fig. 12.137a</a>, LEDs can be driven directly by logic through a current-limiting resistor. Current can be sunk or sourced as shown, although it is better to sink when using TTL. Because an LED’s forward voltage drop (<span class="italic">V<sub class="calibre37"><small class="calibre28"><span class="calibre17">F</span></small></sub></span>) and forward current (<span class="italic">I<sub class="calibre37"><small class="calibre28"><span class="calibre17">F</span></small></sub></span>) can vary from 1.0 to 3.6 <span class="italic">V</span> and 1 to 20 mA, respectively, it is best to select current-limiting resistors that obey the equation shown in the figure. If an LED requires more current than the logic can supply or sink, a transistor output stage like the one shown in <a href="#filepos2948766">Fig. 12.137f</a> can be used.</span></div>
<div class="calibre26"><span><a href="#filepos2948766">Figure 12.137b</a> shows a simple way to get dual-lighting action from a pair of LEDs. When the gate’s output goes low, the upper green LED turns on, while the lower red LED turns off. The LEDs switch states when the output goes high.</span></div>
<div class="calibre26"><span><a></a>Relays will draw considerable current. To avoid damaging the logic device, in <a href="#filepos2948766">Fig. 12.137c</a>, a power MOSFET transistor is attached to the logic output. The diode is used to protect the circuit from current spikes generated by relay as it switches states.</span></div>
<div class="calibre26"><span>A handy method for interfacing standard logic with loads is to use a gate with an open-collector output as a go-between. Recall that open-collector gates cannot source current; they can only sink current. However, they typically can sink ten times the current of a standard logic gate. In <a href="#filepos2948766">Fig. 12.137d</a>, an open-collector gate is used to drive a relay. Check the current ratings of specific open-collector devices before using them to be sure they can handle the load current.</span></div>
<div class="calibre26"><span><a href="#filepos2948766">Figure 12.137e</a> shows another open-collector application. In <a href="#filepos2948766">Fig. 12.137f</a>, a bipolar transistor is used to increase the output drive current used to drive a high-current LED. Make sure the transistor is of the proper current rating.</span></div>
<div class="calibre26"><span><a href="#filepos2948766">Figure 12.137g</a> is basically the same as the previous example, but the load can be something other than an LED.</span></div>
<div class="calibre26"><span>In <a href="#filepos2948766">Fig. 12.137h</a>, an optocoupler is used to drive a load that requires electrical isolation from the logic driving it. Electrical isolation is often used in situations where external loads use a separate ground system. The voltage level at the load side of the optical interface can be set via <span class="italic">V<sub class="calibre37"><small class="calibre28"><span class="calibre17">CC</span></small></sub></span>. There are many different types of optocouplers available (see <a href="CR%21QKYKJ7KY3158K36EJE0G9AYNF2ZW_split_011.html#filepos1857925">Chapter 5</a>).</span></div>
<div id="filepos2952344" class="calibre48"><span class="bold"><span class="italic"><span><span class="bold"><span class="italic">12.10.3   Analog Switches</span></span></span></span></span></div>
<div class="calibre11"><span>Analog switches are ICs designed to switch analog signals via digital control. The internal structure of these devices typically consists of a number of logic control gates interfaced with transistor stages used to control the flow of analog signals.</span></div>
<div class="calibre26"><span><a></a><a href="#filepos2953763">Figure 12.138</a> shows various types of analog switches. The CMOS 4066B quad bilateral switch uses a single-supply voltage from 3 to 15 V. It can switch analog or digital signals within ±7.5 V and has a maximum power dissipation of around 700 mW. Individual switches are controlled by digital inputs <span class="italic">A</span> through <span class="italic">D</span>. The TTL-compatible AH0014D DPDT analog switch can switch analog signals of ±10 V via the <span class="italic">A</span> and <span class="italic">B</span> logic control inputs. Note that this device has separate analog and digital supplies: <span class="italic">V</span>+ and <span class="italic">V</span>− are analog; <span class="italic">V<sub class="calibre37"><small class="calibre28"><span class="calibre17">CC</span></small></sub></span> and GND are digital. The DG302A dual-channel CMOS DPST analog switch can switch analog signals within the ±10-V range at switching speeds up to 15 ns.</span></div>
<div id="filepos2953763" class="calibre3"><span><img alt="image" src="images/01846.jpg" class="calibre172"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.138</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span>A number of circuits use analog switches. They are found in modulator/demodulator circuits, digitally controlled frequency circuits, analog signal-gain circuits, and analog-to-digital conversion circuits, where they often act as sample-hold switches. They can, of course, be used simply to turn a given analog device on or off.</span></div>
<div id="filepos2954457" class="calibre48"><span class="bold"><span class="italic"><span><span class="bold"><span class="italic">12.10.4   Analog Multiplexer/Demultiplexer</span></span></span></span></span></div>
<div class="calibre11"><span>Recall from <a href="CR%21QKYKJ7KY3158K36EJE0G9AYNF2ZW_split_017.html#filepos2701695">Section 12.3</a> that a digital multiplexer acts like a data selector, while a digital demultiplexer acts like a data distributor. Analog multiplexers and demultiplexers act the same way but are capable of selecting or distributing analog signals. (They still use digital select inputs to select which pathways are open and which are closed to signal transmission.)</span></div>
<div class="calibre26"><span>A popular analog multiplexer/demultiplexer IC is the 4051B, shown in <a href="#filepos2956097">Fig. 12.139</a>. This device functions as either a multiplexer or demultiplexer, since its inputs and outputs are bidirectional (signals can flow in either direction). When used as a multiplexer, analog signals enter through I/O lines 0 through 7, while the digital code that selects which input is passed to the analog O/I line (pin 3) is applied to digital inputs <span class="italic">A</span>, <span class="italic">B</span>, and <span class="italic">C</span>. See the truth table in the figure. When used as a demultiplexer, the connections are reversed: The analog input comes in through the analog O/I line (pin 3) and passes out through one of the seven analog I/O lines. The specific output is again selected by the digital inputs <span class="italic">A</span>, <span class="italic">B</span>, and <span class="italic">C</span>. Note that when the inhibit line (INH) is high, none of the addresses are selected.</span></div>
<div id="filepos2956097" class="calibre3"><span><img alt="image" src="images/01847.jpg" class="calibre865"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.139</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span><a></a>The I/O analog voltage levels for the 4051B are limited to a region between the positive supply voltage <span class="italic">V<sub class="calibre37"><small class="calibre28"><span class="calibre17">DD</span></small></sub></span> and the analog negative supply voltage <span class="italic">V<sub class="calibre37"><small class="calibre28"><span class="calibre17">EE</span></small></sub></span>. Note that the <span class="italic">V<sub class="calibre37"><small class="calibre28"><span class="calibre17">SS</span></small></sub></span> supply is grounded. If the analog signals you are planning to use are all positive, <span class="italic">V<sub class="calibre37"><small class="calibre28"><span class="calibre17">EE</span></small></sub></span> and <span class="italic">V<sub class="calibre37"><small class="calibre28"><span class="calibre17">SS</span></small></sub></span> can both be connected to a common ground. However, if you plan to use analog voltages that range from, say, −5 to +5 V, <span class="italic">V<sub class="calibre37"><small class="calibre28"><span class="calibre17">EE</span></small></sub></span> should be set to −5 V, while <span class="italic">V<sub class="calibre37"><small class="calibre28"><span class="calibre17">DD</span></small></sub></span> should be set to +5 V. The 4051B accepts digital signals from 3 to 15 V, while allowing for analog signals from −15 to +15 V.</span></div>
<div id="filepos2957432" class="calibre48"><span class="bold"><span class="italic"><span><span class="bold"><span class="italic">12.10.5   Analog-to-Digital and Digital-to-Analog Conversion</span></span></span></span></span></div>
<div class="calibre11"><span>In order for analog devices (speakers, temperature sensors, strain gauges, position sensors, light meters, and so on) to communicate with digital circuits in a manner that goes beyond simple threshold triggering, we use an analog-to-digital converter (ADC). An ADC converts an analog signal into a series of binary numbers, each number proportional to the analog level measured at a given moment. Typically, the digital words generated by the ADC are fed into a microprocessor or microcontroller, where they can be processed, stored, interpreted, and manipulated. Analog-to-digital conversion is used in data-acquisition systems, digital sound recording, and within simple digital display test instruments (such as light meters and thermometers).</span></div>
<div class="calibre26"><span>In order for a digital circuit to communicate with the analog world, we use a digital-to-analog converter (DAC). A DAC takes a binary number and converts it to an analog voltage that is proportional to the binary number. By supplying different binary numbers, one after the other, a complete analog waveform is created. DACs are commonly used to control the gain of an op amp, which in turn can be used to create digitally controlled amplifiers and filters. They are also used in waveform generator and modulator circuits and as trimmer replacements, and are found in a number of process-control and autocalibration circuits.</span></div>
<div class="calibre26"><span>Many digital consumer products such as MP3 players, DVDs, and CD players use digital signal processing ADCs and DACs.</span></div>
<div class="calibre3"><span><span class="bold">ADC and DAC Basics</span></span></div>
<div class="calibre11"><span><a></a><a href="#filepos2960153">Figure 12.140</a> shows the basic idea behind analog-to-digital and digital-to-analog conversion. In the analog-to-digital figure, the ADC receives an analog input signal along with a series of digital sampling pulses. Each time a sampling pulse is received, the ADC measures the analog input voltage and outputs a 4-bit binary number that is proportional to the analog voltage measured during the specific sample. With 4 bits, we get 16 binary codes (0000 to 1111) that correspond to 16 possible analog levels (for example, 0 to 15 V).</span></div>
<div id="filepos2960153" class="calibre3"><span><img alt="image" src="images/01848.jpg" class="calibre231"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.140</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span>In the digital-to-analog conversion figure, the DAC receives a series of 4-bit binary numbers. The rate at which new binary numbers are fed into the DAC is determined by the logic that generates them. With each new binary number, a new analog voltage is generated. As with the ADC example, we have a total of 16 binary numbers to work with and 16 possible output voltages.</span></div>
<div class="calibre26"><span>As you can see from the graphs, both these 4-bit converters lack the resolution needed to make the analog signal appear continuous (without steps). To make things appear more continuous, a converter with higher resolution is used. This means that instead of using 4-bit binary numbers, we use larger-bit numbers, such as 6-bit, 8-bit, 10-bit, 12-bit, 16-bit, or even 18-bit or higher numbers. If our converter has a resolution of 8 bits, we have 2<sup class="calibre29"><small class="calibre28"><span class="calibre17">8</span></small></sup> = 256 binary numbers to work with, along with 256 analog steps. Now, if this 8-bit converter is set up to generate 0 V at binary 00000000 and 15 V at binary 11111111 (full scale), then each analog step is only 0.058 V high (<img alt="image" src="images/01849.jpg" class="calibre1569"/> × 15 V). With an 18-bit converter, the steps get incredibly tiny because we have 2<sup class="calibre29"><small class="calibre28"><span class="calibre17">18</span></small></sup> = 262,144 binary numbers and steps. With 0 V corresponding to binary 000000000000000000 and 15 V corresponding to 111111111111111111, the 18-bit converter yields steps that are only 0.000058 V high! As you can see in the 18-bit case, the conversion process between digital and analog appears practically continuous.</span></div>
<div class="calibre3"><span><span class="bold">Simple Binary-Weighted DAC</span></span></div>
<div class="calibre11"><span><a href="#filepos2963299">Figure 12.141</a> shows a simple 4-bit DAC that is constructed from a digitally controlled switch (74HC4066), a set of binary-weighted resistors, and an operational amplifier. The basic idea is to create an inverting amplifier circuit whose gain is controlled by changing the input resistance <span class="italic">R</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">in</span></small></sub>. The 74HC4066 and the resistors together act as a digitally controlled <span class="italic">R</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">in</span></small></sub> that can take on one of 16 possible values. You can think of the 74HC4066 and resistor combination as a digitally controlled current source. Each new binary code applied to the inputs of the 74HC4066 generates a new discrete current level that is summed by <span class="italic">R<sub class="calibre37"><small class="calibre28"><span class="calibre17">F</span></small></sub></span> to provide a new discrete output voltage level.</span></div>
<div id="filepos2963299" class="calibre3"><span><img alt="image" src="images/01850.jpg" class="calibre112"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.141</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span><a></a>We choose scaled resistor values of <span class="italic">R</span>, <span class="italic">R</span>/2, <span class="italic">R</span>/4, and <span class="italic">R</span>/8 to give <span class="italic">R</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">in</span></small></sub> discrete values that are equally spaced. To find all possible values of Rin, we use the formula provided in <a href="#filepos2963299">Fig. 12.141</a>. This formula looks like the old resistors-in-parallel formula, but we must exclude those resistors that are not selected by the digital input code—that’s what the coefficients <span class="italic">A</span> through D are for (a coefficient is either 1 or 0, depending on the digital input).</span></div>
<div class="calibre26"><span>To find the analog output voltage, we simply use <span class="italic">V</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">out</span></small></sub> = −<span class="italic">V</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">ref</span></small></sub>(<span class="italic">R<sub class="calibre37"><small class="calibre28"><span class="calibre17">F</span></small></sub></span>/<span class="italic">R</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">in</span></small></sub>)—the expression used for the inverting amplifier (see <a href="CR%21QKYKJ7KY3158K36EJE0G9AYNF2ZW_split_014.html#filepos2297020">Chapter 8</a>). <a href="#filepos2963299">Figure 12.141</a> shows what we get when we set <span class="italic">V</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">ref</span></small></sub> = −5 V, <span class="italic">R</span> = 100 kΩ, and <span class="italic">R<sub class="calibre37"><small class="calibre28"><span class="calibre17">F</span></small></sub></span> = 20 kΩ, and take all possible input codes.</span></div>
<div class="calibre26"><span>The binary-weighted DAC shown in <a href="#filepos2963299">Fig. 12.141</a> is limited in resolution (4-bit, 16 analog levels). To double the resolution (make an 8-bit DAC), you might consider adding another 74HC4066 and <span class="italic">R</span>/16, <span class="italic">R</span>/32, <span class="italic">R</span>/64, and <span class="italic">R</span>/128 resistors. In theory, this works; in reality, it doesn’t. The problem with this approach is that when we reach the <span class="italic">R</span>/128 resistor, we must find a 0.78125-kΩ resistor, assuming <span class="italic">R</span> = 100 kΩ. Assuming we can find or construct an equivalent resistor network for <span class="italic">R</span>/128, we’re still in trouble because the tolerances of these resistors will cause problems. This scaled-resistor approach becomes impractical when we deal with resolutions of more than a few bits. To increase the resolution, we scrap the scaled-resistor network and replace it with an <span class="italic">R</span>/2R ladder network. The manufacturers of DAC ICs do this as well.</span></div>
<div class="calibre3"><span><span class="bold">R/2R Ladder DAC</span></span></div>
<div class="calibre11"><span>An <span class="italic">R</span>/2<span class="italic">R</span> DAC uses an <span class="italic">R</span>/2<span class="italic">R</span> resistor ladder network instead of a scaled-resistor network, as was the case in the previous DAC. The benefit of using the <span class="italic">R</span>/2<span class="italic">R</span> ladder is that we need only two resistor values: <span class="italic">R</span> and 2<span class="italic">R</span>. <a href="#filepos2966724">Figure 12.142</a> shows a simple 4-bit <span class="italic">R</span>/2<span class="italic">R</span> DAC. For now, assume that the switches are digitally controlled (in real DACs, they are replaced with transistors).</span></div>
<div id="filepos2966724" class="calibre3"><span><img alt="image" src="images/01851.jpg" class="calibre244"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.142</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span><a></a>The trick to understanding how the <span class="italic">R</span>/2<span class="italic">R</span> ladder works is realizing that the current drawn through any one switch is always the same, no matter if it is thrown up or down. If a switch is thrown down, current will flow through the switch into ground (0 V). If a switch is thrown up, current will flow toward virtual ground—located at the op amp’s inverting input (recall that if the noninverting input of an op amp is set to 0 V, the op amp will make the inverting input 0 V, via negative feedback). Once you realize that the current through any given switch is always constant, you can figure that the total current (<span class="italic">I</span>) supplied by <span class="italic">V</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">ref</span></small></sub> will be constant as well. Once you have that, you figure out what fractions of the total current pass through each of the branches within the <span class="italic">R</span>/2<span class="italic">R</span> network using simple circuit analysis. <a href="#filepos2966724">Figure 12.142</a> shows that <span class="italic">½I</span> passes through S<sub class="calibre37"><small class="calibre28"><span class="calibre17">3</span></small></sub> (MSB switch), ¼<span class="italic">I</span> through <span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">2,</span></small></sub><img alt="image" src="images/00093.jpg" class="calibre123"/><span class="italic">I</span> through <span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">1</span></small></sub> and <img alt="image" src="images/00856.jpg" class="calibre788"/><span class="italic">I</span> through <span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> (LSB switch). If you’re interested in how that was figured out, the circuit reduction shown in <a href="#filepos2968683">Fig. 12.143</a> should help.</span></div>
<div id="filepos2968683" class="calibre3"><span><img alt="image" src="images/01852.jpg" class="calibre1285"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.143</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span>Now that we have a means of consistently generating fractions of ½<span class="italic">I</span>, ¼<span class="italic">I</span>,<img alt="image" src="images/00093.jpg" class="calibre123"/><span class="italic">I</span>, and <span class="italic"><img alt="image" src="images/00856.jpg" class="calibre788"/>I</span>, we can choose, via the digital input switches, which fractions are summed together by the amplifier. For example, if switches <span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">3</span></small></sub>, <span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">2</span></small></sub>, <span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">1</span></small></sub>, and <span class="italic">S</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub> are thrown to 0101 (5), ¼<span class="italic">I</span> + <img alt="image" src="images/00856.jpg" class="calibre788"/><span class="italic">I</span> combine to form I<sub class="calibre37"><small class="calibre28"><span class="calibre17">sum</span></small></sub>. But what is <span class="italic">I</span>? Using Ohm’s law, it’s just <span class="italic">I</span> = <span class="italic">V</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">ref</span></small></sub> / <span class="italic">R</span> = +5 V / 10 kΩ = 500 µA. This means that <span class="italic">I</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">sum</span></small></sub> = ¼(500 µA) + <img alt="image" src="images/00856.jpg" class="calibre788"/>(500 µA) = 156.25 µA. The final output voltage is determined by <span class="italic">V</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">out</span></small></sub> = −<span class="italic">I</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">sum</span></small></sub><span class="italic">R<sub class="calibre37"><small class="calibre28"><span class="calibre17">F</span></small></sub></span> = − (156.25 µA)(20 <span class="italic">kΩ</span>) = -3.125 V. The formulas and the table in <a href="#filepos2966724">Fig. 12.142</a> show the other possible binary/analog combinations.</span></div>
<div class="calibre26"><span>To create an <span class="italic">R</span>/2<span class="italic">R</span> DAC with higher resolution, we simply add more runs and switches to the ladder.</span></div>
<div class="calibre3"><span><a></a><span class="bold">Integrated DACs</span></span></div>
<div class="calibre11"><span>Often, making DACs from scratch isn’t worth the effort. The cost as well as the likelihood for conversion errors is great. The best thing to do is to simply buy a DAC IC. You can buy these devices from a number of different manufacturers (such as National Semiconductor, Analog Devices, and Texas Instruments). The typical resolutions for these ICs are 6, 8, 10, 12, 16, and 18 bits. DAC ICs also may come with a serial digital input, as opposed to the parallel input scheme shown in <a href="#filepos2963299">Figs 12.141</a> and <a href="#filepos2966724">12.142</a>. Before a serial-input DAC can make a conversion, the entire digital word must be clocked into an internal shift register.</span></div>
<div class="calibre26"><span>Most often, DAC ICs come with an external reference input that is used to set the analog output range. There are some DACs that have fixed references, but these are becoming rare.</span></div>
<div class="calibre26"><span>Often, you’ll see a manufacturer list one of its DACs as being a multiplying DAC. A multiplying DAC can produce an output signal that is proportional to the product of a varying input reference level (voltage or current) times a digital code. As it turns out, most DACs, even those that are specifically designated as multiplying DAC on the data sheets, can be used for multiplying purposes simply by using the reference input as the analog input. However, many such ICs do not provide the same quality multiplying characteristics, such as a wide analog input range and fast conversion times, as those that are called <span class="italic">multiplying</span> DACs.</span></div>
<div class="calibre26"><span>Multiplying is most commonly applied in systems that use ratiometeric transducers (for example, position potentiometers, strain gauges, and pressure transducers). These transducers require an external analog voltage to act as a reference level on which to base analog output responses. If this reference level is altered, say, by an unwanted supply surge, the transducer’s output will change in response, and this results in conversion errors at the DAC end. However, if we use a multiplying DAC, we eliminate these errors by feeding the transducer’s reference voltage to the DAC’s analog input. If any supply voltage/current errors occur, the DAC will alter its output in proportion to the analog error.</span></div>
<div class="calibre26"><span>DACs are capable of producing unipolar (single-polarity output) or bipolar (positive and negative) output signals. In most cases, when a DAC is used in unipolar mode, the digital code is expressed in standard binary. When used in bipolar mode, the most common code is either offset binary or 2’s complement. Offset binary and 2’s complement codes make it possible to express both positive and negative values. <a href="#filepos2974226">Figure 12.144</a> shows all three codes and their corresponding analog output levels (referenced from an external voltage source).</span></div>
<div id="filepos2974226" class="calibre3"><span><img alt="image" src="images/01853.jpg" class="calibre1570"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.144</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span>Note that in the figure, FS stands for full scale, which is the maximum analog level that can be reached when applying the highest binary code. It is important to realize that at full scale, the analog output for an <span class="italic">n</span>-bit converter is actually (2<span class="italic"><sup class="calibre29"><small class="calibre28"><span class="calibre17">n</span></small></sup></span> − 1) / 2<span class="italic"><sup class="calibre29"><small class="calibre28"><span class="calibre17">n</span></small></sup></span> × <span class="italic">V</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">ref</span></small></sub>, not 2<span class="italic"><sup class="calibre29"><small class="calibre28"><span class="calibre17">n</span></small></sup></span>/2<span class="italic"><sup class="calibre29"><small class="calibre28"><span class="calibre17">n</span></small></sup></span> × <span class="italic">V</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">ref</span></small></sub>. For example, for an 8-bit converter, the number of binary numbers is 2<sup class="calibre29"><small class="calibre28"><span class="calibre17">8</span></small></sup> = 256, while the maximum analog output level is 255/256 <span class="italic">V</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">ref</span></small></sub>, not 256/256 <span class="italic">V</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">ref</span></small></sub>, since the highest binary number is 255 (1111 1111). The “missing count” is used up by the LSB-1 condition (0 state).</span></div>
<div class="calibre3"><span><span class="bold">Example DAC ICs</span></span></div>
<div class="calibre3"><span><span class="bold">DAC0808 8-BIT DAC</span></span></div>
<div class="calibre11"><span><a></a>The DAC0808 (National Semiconductor) is a popular 8-bit DAC that requires an input reference current and supplies 1 of 256 analog output current levels. <a href="#filepos2976302">Figure 12.145</a> shows a block diagram of the DAC0808, along with its IC pin configuration and a sample application circuit.</span></div>
<div id="filepos2976302" class="calibre3"><span><img alt="image" src="images/01854.jpg" class="calibre416"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.145</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span><a></a>In the application circuit, the analog output range is set by applying a reference current (<span class="italic">I</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">ref</span></small></sub>) to pin 14 (+<span class="italic">V</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">ref</span></small></sub>). In this example, <span class="italic">I</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">ref</span></small></sub> is set to 2 mA via an external +10 V/5 kΩ resistor combination. Note that another 5-kΩ resistor is required between pin 15 (−<span class="italic">V</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">ref</span></small></sub>) and ground.</span></div>
<div class="calibre26"><span>To determine the DAC’s analog output current (<span class="italic">I</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">out</span></small></sub>) for all possible binary inputs, we use the following formula:</span></div>
<div class="calibre19"><span><img alt="image" src="images/01855.jpg" class="calibre1571"/></span></div>
<div class="calibre30"><span>At full scale (all A’s high or binary 255), <span class="italic">I</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">out</span></small></sub> = <span class="italic">I</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">ref</span></small></sub> (255/256) = (2 mA)(0.996) = 1.99 mA. Considering that the DAC has 256 analog output levels, we can figure that each corresponding level is spaced 1.99 mA/256 = 0.0078 mA apart.</span></div>
<div class="calibre26"><span>To convert the analog output currents into analog output voltages, we attach the op amp. Using the op amp rules from <a href="CR%21QKYKJ7KY3158K36EJE0G9AYNF2ZW_split_014.html#filepos2297020">Chapter 8</a>, we find that the output voltage is <span class="italic">V</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">out</span></small></sub> = <span class="italic">I</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">out</span></small></sub> × <span class="italic">R<sub class="calibre37"><small class="calibre28"><span class="calibre17">f</span></small></sub></span>. At full scale, <span class="italic">V</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">out</span></small></sub> = (1.99 mA)(5 kΩ) = 9.95 V. Each analog output level is spaced 9.95 V/256 = 0.0389 <span class="italic">V</span> apart.</span></div>
<div class="calibre26"><span>The DAC0808 can be configured as a multiplying DAC by applying the analog input signal to the reference input. In this case, however, the analog input current should be limited to a range from 16 μA to 4 mA to retain reasonable accuracy. See the National Semiconductor’s data sheets for more details.</span></div>
<div class="calibre3"><span><span class="bold">DAC8043A SERIAL 12-BIT INPUT MULTIPLYING DAC</span></span></div>
<div class="calibre11"><span>The DAC8083A (Analog Devices) is a high-precision 12-bit CMOS multiplying DAC that comes with a serial digital input. <a href="#filepos2979591">Figure 12.146</a> shows a block diagram, pin configuration, and write cycle timing diagram for this device.</span></div>
<div id="filepos2979591" class="calibre3"><span><img alt="image" src="images/01856.jpg" class="calibre405"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.146</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span>Before the DAC8043 can make a conversion, serial data must be clocked into the input register by supplying an external clock signal (each positive edge of the clock load one bit). Once loaded, the input register’s contents are dumped off to the DAC register by applying a low pulse to the <span class="italic"><img alt="image" src="images/01857.jpg" class="calibre1572"/></span> line. Data in the DAC register is then converted to an output current through the Iout terminal.</span></div>
<div class="calibre26"><span>In most applications, this current is then transformed into a voltage by an op amp stage, as is the case within the two circuits shown in <a href="#filepos2981008">Fig. 12.147</a>. In the unipolar (two-quadrant) circuit, a standard binary code is used to select from 4096 possible analog output levels. In the bipolar (four-quadrant) circuit, an offset binary code is used again to select from 4096 analog output levels, but now the range is broken up to accommodate both positive and negative polarities.</span></div>
<div id="filepos2981008" class="calibre3"><span><img alt="image" src="images/01858.jpg" class="calibre1573"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.147</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span><a></a>If you’re interested in learning more about the DAC8043, go to Analog Device’s website and check out the data sheet.</span></div>
<div class="calibre26"><span>Another very similar device worth considering is the MAX522.</span></div>
<div id="filepos2981662" class="calibre48"><span class="bold"><span class="italic"><span><span class="bold"><span class="italic">12.10.6   Analog-to-Digital Converters</span></span></span></span></span></div>
<div class="calibre11"><span>There are a number of techniques used to convert analog signals into digital signals. The most popular techniques include successive approximation conversion and parallel-encoded conversion (or flash conversion). Other techniques include half-flash conversion, delta-sigma processing, and pulse-code modulation (PCM). In this section, we’ll focus on the successive approximation and parallel-encoded conversion techniques.</span></div>
<div class="calibre3"><span><span class="bold">Successive Approximation</span></span></div>
<div class="calibre11"><span>Successive approximation analog-to-digital conversion is the most common approach used in integrated ADCs. In this conversion technique, each bit of the binary output is found, one bit at a time—MSB first. This technique yields fairly fast conversion times (from around 10 to 300 μ<span class="italic">s</span>) with a limited amount of circuitry. <a href="#filepos2983055">Figure 12.148</a> shows a simple 8-bit successive approximation ADC, along with an example analog-to-digital conversion sequence.</span></div>
<div id="filepos2983055" class="calibre3"><span><img alt="image" src="images/01859.jpg" class="calibre1489"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.148</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span><a></a>To begin a conversion, the <img alt="image" src="images/01860.jpg" class="calibre1574"/> (start conversion) input is pulsed low. This causes the successive approximation register (SAR) to first apply a high on the MSB (<span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">7</span></small></sub>) line of the DAC. With only <span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">7</span></small></sub> high, the DAC’s output is driven to one-half its full-scale level, which in this case is +5 <span class="italic">V</span> because the full-scale output is +10 V. The +5-V output level from the DAC is then compared with the analog input level, via the comparator. If the analog input level is greater than +5 V, the SAR keeps the <span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">7</span></small></sub> line high; otherwise, the SAR returns the <span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">7</span></small></sub> line low. At the next clock pulse, the next bit (<span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">6</span></small></sub>) is tried. Again, if the analog input level is larger than the DAC’s output level, <span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">6</span></small></sub> is left high; otherwise, it is returned low.</span></div>
<div class="calibre26"><span>During the next six clock pulses, the rest of the bits are tried. After the last bit (LSB) is tried, the <span class="italic">CC</span> (conversion complete) output of the SAR goes low, indicating that a valid 8-bit conversion is complete, and the binary data is ready to be clocked into the octal flip-flop, where it can be presented to the <span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">0</span></small></sub>–<span class="italic">Q</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">7</span></small></sub> outputs.</span></div>
<div class="calibre26"><span>The timing diagram shows a 3.8652-V analog level being converted into an approximate digital equivalent. Note that after the first approximation (the <span class="italic">D</span><sub class="calibre37"><small class="calibre28"><span class="calibre17">7</span></small></sub> try), the percentage error between the actual analog level and corresponding digital equivalent is 29.360 percent. However, after the final approximation, the percentage error is reduced to only 0.051 percent.</span></div>
<div class="calibre26"><span>Until now, we’ve assumed that the analog input to our ADC was constant during the conversion. But what happens when the analog input changes during conversion time? Errors result. The more rapidly the analog input changes during the conversion time, the more pronounced the errors will become. To prevent such errors, a sample-and-hold circuit is often attached to the analog input. With an external control signal, this circuit can be made to sample the analog input voltage and hold the sample while the ADC makes the conversion.</span></div>
<div class="calibre26"><span>With the exception of very high-speed ADCs, separate ADC ICs are now largely redundant and have been replaced with microcontrollers containing 12-bit or higher ADC channels.</span></div>
<div class="calibre3"><span><a></a><span class="bold">Parallel-Encoded Analog-to-Digital Conversion (Flash Conversion)</span></span></div>
<div class="calibre11"><span>Parallel-encoded analog-to-digital conversion, or flash conversion, is perhaps the easiest conversion process to understand. To illustrate the basics behind parallel encoding (also referred to as <span class="italic">simultaneous multiple comparator or flash converting</span>), let’s take a look at the simple 3-bit converter in <a href="#filepos2987120">Fig. 12.149</a>.</span></div>
<div id="filepos2987120" class="calibre3"><span><img alt="image" src="images/01861.jpg" class="calibre1050"/></span></div>
<div class="calibre34"><span class="calibre17"><span class="bold"><span>FIGURE 12.149</span></span></span></div><div class="calibre35"> </div>
<div class="calibre26"><span>The set of comparators is the key feature to note in this circuit. Each comparator is supplied with a different reference voltage from the 1 kΩ voltage divider network. Since we’ve set up a +5V reference voltage, the voltage drop across each resistor within the voltage divider network is 0.625 V. From this, you can determine the specific reference voltages given to each comparator (see <a href="#filepos2987120">Fig. 12.149</a>).</span></div>
</body></html>
